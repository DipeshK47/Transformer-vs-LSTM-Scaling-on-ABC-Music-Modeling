==============================
Starting training for tiny
==============================
/scratch/dk5288/envs/cv6643/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:182: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:106: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
[train] Starting training for model_size=tiny
[train] Output directory: /scratch/dk5288/models2/abc_scaling
[train] Using device: cuda
[train] Vocab size: 99
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/train.txt (max_chars=150000000)
[load_text] Loaded 150000000 characters
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/val.txt (max_chars=5000000)
[load_text] Loaded 5000000 characters
[encode_text] Encoding text to ids...
[encode_text] Encoded 150000000 tokens
[encode_text] Encoding text to ids...
[encode_text] Encoded 5000000 tokens
[train] tokens_per_step = 16384
[train] max_steps (one epoch over ~150000000 tokens) = 9155
[get_model_config] Built config 'tiny' (layers=2, heads=6, emb=192, block_size=256, vocab_size=99)
[GPT] Initialized model: layers=2, heads=6, emb=192, block_size=256, params=0.96M
[train] Model tiny has 956736 parameters (0.96M)
[train] Beginning training loop...
[train] step 0/9155 train_loss=4.6264 lr=6.56e-07 elapsed=0.02 min
[eval] step 0 val_loss=4.6198
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 50/9155 train_loss=3.5191 lr=3.35e-05 elapsed=0.04 min
[train] step 100/9155 train_loss=1.9232 lr=6.63e-05 elapsed=0.04 min
[train] step 150/9155 train_loss=1.2354 lr=9.91e-05 elapsed=0.05 min
[train] step 200/9155 train_loss=0.7448 lr=1.32e-04 elapsed=0.05 min
[train] step 250/9155 train_loss=0.5656 lr=1.65e-04 elapsed=0.06 min
[train] step 300/9155 train_loss=0.5259 lr=1.98e-04 elapsed=0.06 min
[train] step 350/9155 train_loss=0.4787 lr=2.30e-04 elapsed=0.07 min
[train] step 400/9155 train_loss=0.3949 lr=2.63e-04 elapsed=0.07 min
[train] step 450/9155 train_loss=0.5213 lr=2.96e-04 elapsed=0.08 min
[train] step 500/9155 train_loss=0.5129 lr=2.99e-04 elapsed=0.08 min
[eval] step 500 val_loss=1.5644
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 550/9155 train_loss=0.6233 lr=2.97e-04 elapsed=0.10 min
[train] step 600/9155 train_loss=0.4868 lr=2.95e-04 elapsed=0.10 min
[train] step 650/9155 train_loss=0.6002 lr=2.93e-04 elapsed=0.11 min
[train] step 700/9155 train_loss=0.4254 lr=2.92e-04 elapsed=0.11 min
[train] step 750/9155 train_loss=0.5130 lr=2.90e-04 elapsed=0.12 min
[train] step 800/9155 train_loss=0.2630 lr=2.88e-04 elapsed=0.12 min
[train] step 850/9155 train_loss=0.3993 lr=2.86e-04 elapsed=0.13 min
[train] step 900/9155 train_loss=0.2839 lr=2.85e-04 elapsed=0.13 min
[train] step 950/9155 train_loss=0.3233 lr=2.83e-04 elapsed=0.14 min
[train] step 1000/9155 train_loss=0.3669 lr=2.81e-04 elapsed=0.14 min
[eval] step 1000 val_loss=1.4339
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 1050/9155 train_loss=0.4821 lr=2.80e-04 elapsed=0.16 min
[train] step 1100/9155 train_loss=0.2875 lr=2.78e-04 elapsed=0.16 min
[train] step 1150/9155 train_loss=0.3255 lr=2.76e-04 elapsed=0.17 min
[train] step 1200/9155 train_loss=0.2906 lr=2.74e-04 elapsed=0.17 min
[train] step 1250/9155 train_loss=0.2643 lr=2.73e-04 elapsed=0.18 min
[train] step 1300/9155 train_loss=0.3743 lr=2.71e-04 elapsed=0.18 min
[train] step 1350/9155 train_loss=0.4898 lr=2.69e-04 elapsed=0.19 min
[train] step 1400/9155 train_loss=0.3558 lr=2.67e-04 elapsed=0.19 min
[train] step 1450/9155 train_loss=0.3952 lr=2.66e-04 elapsed=0.20 min
[train] step 1500/9155 train_loss=0.3146 lr=2.64e-04 elapsed=0.20 min
[eval] step 1500 val_loss=1.3805
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 1550/9155 train_loss=0.1885 lr=2.62e-04 elapsed=0.22 min
[train] step 1600/9155 train_loss=0.5213 lr=2.61e-04 elapsed=0.22 min
[train] step 1650/9155 train_loss=0.4427 lr=2.59e-04 elapsed=0.23 min
[train] step 1700/9155 train_loss=0.3710 lr=2.57e-04 elapsed=0.23 min
[train] step 1750/9155 train_loss=0.4077 lr=2.55e-04 elapsed=0.24 min
[train] step 1800/9155 train_loss=0.5698 lr=2.54e-04 elapsed=0.24 min
[train] step 1850/9155 train_loss=0.2835 lr=2.52e-04 elapsed=0.25 min
[train] step 1900/9155 train_loss=0.2920 lr=2.50e-04 elapsed=0.25 min
[train] step 1950/9155 train_loss=0.3195 lr=2.49e-04 elapsed=0.26 min
[train] step 2000/9155 train_loss=0.3196 lr=2.47e-04 elapsed=0.26 min
[eval] step 2000 val_loss=1.3714
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 2050/9155 train_loss=0.3043 lr=2.45e-04 elapsed=0.28 min
[train] step 2100/9155 train_loss=0.3622 lr=2.43e-04 elapsed=0.28 min
[train] step 2150/9155 train_loss=0.3384 lr=2.42e-04 elapsed=0.29 min
[train] step 2200/9155 train_loss=0.2483 lr=2.40e-04 elapsed=0.29 min
[train] step 2250/9155 train_loss=0.3571 lr=2.38e-04 elapsed=0.30 min
[train] step 2300/9155 train_loss=0.1921 lr=2.36e-04 elapsed=0.30 min
[train] step 2350/9155 train_loss=0.3642 lr=2.35e-04 elapsed=0.31 min
[train] step 2400/9155 train_loss=0.3453 lr=2.33e-04 elapsed=0.31 min
[train] step 2450/9155 train_loss=0.3349 lr=2.31e-04 elapsed=0.32 min
[train] step 2500/9155 train_loss=0.3854 lr=2.30e-04 elapsed=0.32 min
[eval] step 2500 val_loss=1.3237
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 2550/9155 train_loss=0.3409 lr=2.28e-04 elapsed=0.34 min
[train] step 2600/9155 train_loss=0.3280 lr=2.26e-04 elapsed=0.34 min
[train] step 2650/9155 train_loss=0.3756 lr=2.24e-04 elapsed=0.35 min
[train] step 2700/9155 train_loss=0.2048 lr=2.23e-04 elapsed=0.35 min
[train] step 2750/9155 train_loss=0.4170 lr=2.21e-04 elapsed=0.36 min
[train] step 2800/9155 train_loss=0.2670 lr=2.19e-04 elapsed=0.36 min
[train] step 2850/9155 train_loss=0.4269 lr=2.17e-04 elapsed=0.37 min
[train] step 2900/9155 train_loss=0.3984 lr=2.16e-04 elapsed=0.37 min
[train] step 2950/9155 train_loss=0.3317 lr=2.14e-04 elapsed=0.38 min
[train] step 3000/9155 train_loss=0.3463 lr=2.12e-04 elapsed=0.38 min
[eval] step 3000 val_loss=1.2982
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 3050/9155 train_loss=0.1967 lr=2.11e-04 elapsed=0.40 min
[train] step 3100/9155 train_loss=0.2242 lr=2.09e-04 elapsed=0.40 min
[train] step 3150/9155 train_loss=0.3524 lr=2.07e-04 elapsed=0.41 min
[train] step 3200/9155 train_loss=0.2940 lr=2.05e-04 elapsed=0.41 min
[train] step 3250/9155 train_loss=0.4259 lr=2.04e-04 elapsed=0.42 min
[train] step 3300/9155 train_loss=0.3448 lr=2.02e-04 elapsed=0.42 min
[train] step 3350/9155 train_loss=0.2918 lr=2.00e-04 elapsed=0.43 min
[train] step 3400/9155 train_loss=0.2127 lr=1.98e-04 elapsed=0.43 min
[train] step 3450/9155 train_loss=0.3580 lr=1.97e-04 elapsed=0.44 min
[train] step 3500/9155 train_loss=0.4238 lr=1.95e-04 elapsed=0.44 min
[eval] step 3500 val_loss=1.2837
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 3550/9155 train_loss=0.2777 lr=1.93e-04 elapsed=0.46 min
[train] step 3600/9155 train_loss=0.4002 lr=1.92e-04 elapsed=0.46 min
[train] step 3650/9155 train_loss=0.3511 lr=1.90e-04 elapsed=0.47 min
[train] step 3700/9155 train_loss=0.1942 lr=1.88e-04 elapsed=0.47 min
[train] step 3750/9155 train_loss=0.3790 lr=1.86e-04 elapsed=0.48 min
[train] step 3800/9155 train_loss=0.3274 lr=1.85e-04 elapsed=0.48 min
[train] step 3850/9155 train_loss=0.3407 lr=1.83e-04 elapsed=0.49 min
[train] step 3900/9155 train_loss=0.3343 lr=1.81e-04 elapsed=0.49 min
[train] step 3950/9155 train_loss=0.2581 lr=1.80e-04 elapsed=0.50 min
[train] step 4000/9155 train_loss=0.3566 lr=1.78e-04 elapsed=0.50 min
[eval] step 4000 val_loss=1.2438
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 4050/9155 train_loss=0.2592 lr=1.76e-04 elapsed=0.52 min
[train] step 4100/9155 train_loss=0.2232 lr=1.74e-04 elapsed=0.52 min
[train] step 4150/9155 train_loss=0.2882 lr=1.73e-04 elapsed=0.53 min
[train] step 4200/9155 train_loss=0.4190 lr=1.71e-04 elapsed=0.53 min
[train] step 4250/9155 train_loss=0.3458 lr=1.69e-04 elapsed=0.54 min
[train] step 4300/9155 train_loss=0.4081 lr=1.67e-04 elapsed=0.54 min
[train] step 4350/9155 train_loss=0.2459 lr=1.66e-04 elapsed=0.55 min
[train] step 4400/9155 train_loss=0.2457 lr=1.64e-04 elapsed=0.55 min
[train] step 4450/9155 train_loss=0.1552 lr=1.62e-04 elapsed=0.56 min
[train] step 4500/9155 train_loss=0.3685 lr=1.61e-04 elapsed=0.56 min
[eval] step 4500 val_loss=1.2289
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 4550/9155 train_loss=0.2632 lr=1.59e-04 elapsed=0.58 min
[train] step 4600/9155 train_loss=0.2569 lr=1.57e-04 elapsed=0.58 min
[train] step 4650/9155 train_loss=0.2308 lr=1.55e-04 elapsed=0.59 min
[train] step 4700/9155 train_loss=0.2868 lr=1.54e-04 elapsed=0.59 min
[train] step 4750/9155 train_loss=0.3094 lr=1.52e-04 elapsed=0.60 min
[train] step 4800/9155 train_loss=0.3682 lr=1.50e-04 elapsed=0.60 min
[train] step 4850/9155 train_loss=0.2646 lr=1.48e-04 elapsed=0.61 min
[train] step 4900/9155 train_loss=0.2536 lr=1.47e-04 elapsed=0.61 min
[train] step 4950/9155 train_loss=0.3268 lr=1.45e-04 elapsed=0.62 min
[train] step 5000/9155 train_loss=0.2498 lr=1.43e-04 elapsed=0.62 min
[eval] step 5000 val_loss=1.2042
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 5050/9155 train_loss=0.3820 lr=1.42e-04 elapsed=0.64 min
[train] step 5100/9155 train_loss=0.2125 lr=1.40e-04 elapsed=0.64 min
[train] step 5150/9155 train_loss=0.4042 lr=1.38e-04 elapsed=0.65 min
[train] step 5200/9155 train_loss=0.3211 lr=1.36e-04 elapsed=0.65 min
[train] step 5250/9155 train_loss=0.2800 lr=1.35e-04 elapsed=0.66 min
[train] step 5300/9155 train_loss=0.3022 lr=1.33e-04 elapsed=0.66 min
[train] step 5350/9155 train_loss=0.3363 lr=1.31e-04 elapsed=0.67 min
[train] step 5400/9155 train_loss=0.2842 lr=1.30e-04 elapsed=0.67 min
[train] step 5450/9155 train_loss=0.2777 lr=1.28e-04 elapsed=0.68 min
[train] step 5500/9155 train_loss=0.2721 lr=1.26e-04 elapsed=0.68 min
[eval] step 5500 val_loss=1.1718
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 5550/9155 train_loss=0.2216 lr=1.24e-04 elapsed=0.70 min
[train] step 5600/9155 train_loss=0.1655 lr=1.23e-04 elapsed=0.70 min
[train] step 5650/9155 train_loss=0.3166 lr=1.21e-04 elapsed=0.71 min
[train] step 5700/9155 train_loss=0.2518 lr=1.19e-04 elapsed=0.71 min
[train] step 5750/9155 train_loss=0.2857 lr=1.17e-04 elapsed=0.72 min
[train] step 5800/9155 train_loss=0.1822 lr=1.16e-04 elapsed=0.72 min
[train] step 5850/9155 train_loss=0.3305 lr=1.14e-04 elapsed=0.73 min
[train] step 5900/9155 train_loss=0.2747 lr=1.12e-04 elapsed=0.73 min
[train] step 5950/9155 train_loss=0.2551 lr=1.11e-04 elapsed=0.74 min
[train] step 6000/9155 train_loss=0.3256 lr=1.09e-04 elapsed=0.74 min
[eval] step 6000 val_loss=1.1447
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 6050/9155 train_loss=0.2385 lr=1.07e-04 elapsed=0.76 min
[train] step 6100/9155 train_loss=0.2682 lr=1.05e-04 elapsed=0.76 min
[train] step 6150/9155 train_loss=0.3177 lr=1.04e-04 elapsed=0.77 min
[train] step 6200/9155 train_loss=0.2214 lr=1.02e-04 elapsed=0.77 min
[train] step 6250/9155 train_loss=0.2244 lr=1.00e-04 elapsed=0.78 min
[train] step 6300/9155 train_loss=0.1940 lr=9.85e-05 elapsed=0.78 min
[train] step 6350/9155 train_loss=0.2706 lr=9.67e-05 elapsed=0.79 min
[train] step 6400/9155 train_loss=0.1694 lr=9.50e-05 elapsed=0.79 min
[train] step 6450/9155 train_loss=0.1678 lr=9.33e-05 elapsed=0.80 min
[train] step 6500/9155 train_loss=0.2963 lr=9.16e-05 elapsed=0.80 min
[eval] step 6500 val_loss=1.1385
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 6550/9155 train_loss=0.3917 lr=8.98e-05 elapsed=0.82 min
[train] step 6600/9155 train_loss=0.2467 lr=8.81e-05 elapsed=0.82 min
[train] step 6650/9155 train_loss=0.1762 lr=8.64e-05 elapsed=0.83 min
[train] step 6700/9155 train_loss=0.2491 lr=8.47e-05 elapsed=0.83 min
[train] step 6750/9155 train_loss=0.3346 lr=8.30e-05 elapsed=0.84 min
[train] step 6800/9155 train_loss=0.3597 lr=8.12e-05 elapsed=0.84 min
[train] step 6850/9155 train_loss=0.1740 lr=7.95e-05 elapsed=0.85 min
[train] step 6900/9155 train_loss=0.2687 lr=7.78e-05 elapsed=0.85 min
[train] step 6950/9155 train_loss=0.2354 lr=7.61e-05 elapsed=0.86 min
[train] step 7000/9155 train_loss=0.2670 lr=7.43e-05 elapsed=0.86 min
[eval] step 7000 val_loss=1.1144
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 7050/9155 train_loss=0.1820 lr=7.26e-05 elapsed=0.87 min
[train] step 7100/9155 train_loss=0.3177 lr=7.09e-05 elapsed=0.88 min
[train] step 7150/9155 train_loss=0.2110 lr=6.92e-05 elapsed=0.88 min
[train] step 7200/9155 train_loss=0.3083 lr=6.74e-05 elapsed=0.89 min
[train] step 7250/9155 train_loss=0.3407 lr=6.57e-05 elapsed=0.90 min
[train] step 7300/9155 train_loss=0.2100 lr=6.40e-05 elapsed=0.90 min
[train] step 7350/9155 train_loss=0.3211 lr=6.23e-05 elapsed=0.91 min
[train] step 7400/9155 train_loss=0.1733 lr=6.05e-05 elapsed=0.91 min
[train] step 7450/9155 train_loss=0.2950 lr=5.88e-05 elapsed=0.92 min
[train] step 7500/9155 train_loss=0.2717 lr=5.71e-05 elapsed=0.92 min
[eval] step 7500 val_loss=1.1045
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 7550/9155 train_loss=0.2864 lr=5.54e-05 elapsed=0.93 min
[train] step 7600/9155 train_loss=0.2643 lr=5.36e-05 elapsed=0.94 min
[train] step 7650/9155 train_loss=0.1363 lr=5.19e-05 elapsed=0.94 min
[train] step 7700/9155 train_loss=0.3147 lr=5.02e-05 elapsed=0.95 min
[train] step 7750/9155 train_loss=0.2531 lr=4.85e-05 elapsed=0.95 min
[train] step 7800/9155 train_loss=0.2295 lr=4.67e-05 elapsed=0.96 min
[train] step 7850/9155 train_loss=0.1870 lr=4.50e-05 elapsed=0.97 min
[train] step 7900/9155 train_loss=0.2093 lr=4.33e-05 elapsed=0.97 min
[train] step 7950/9155 train_loss=0.2227 lr=4.16e-05 elapsed=0.98 min
[train] step 8000/9155 train_loss=0.2707 lr=3.98e-05 elapsed=0.98 min
[eval] step 8000 val_loss=1.0963
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 8050/9155 train_loss=0.2095 lr=3.81e-05 elapsed=0.99 min
[train] step 8100/9155 train_loss=0.3236 lr=3.64e-05 elapsed=1.00 min
[train] step 8150/9155 train_loss=0.2457 lr=3.47e-05 elapsed=1.00 min
[train] step 8200/9155 train_loss=0.2977 lr=3.29e-05 elapsed=1.01 min
[train] step 8250/9155 train_loss=0.2735 lr=3.12e-05 elapsed=1.01 min
[train] step 8300/9155 train_loss=0.3557 lr=2.95e-05 elapsed=1.02 min
[train] step 8350/9155 train_loss=0.3112 lr=2.78e-05 elapsed=1.02 min
[train] step 8400/9155 train_loss=0.1909 lr=2.60e-05 elapsed=1.03 min
[train] step 8450/9155 train_loss=0.1754 lr=2.43e-05 elapsed=1.04 min
[train] step 8500/9155 train_loss=0.3776 lr=2.26e-05 elapsed=1.04 min
[eval] step 8500 val_loss=1.0796
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/tiny_best.pt
[train] step 8550/9155 train_loss=0.2614 lr=2.09e-05 elapsed=1.05 min
[train] step 8600/9155 train_loss=0.3196 lr=1.91e-05 elapsed=1.06 min
[train] step 8650/9155 train_loss=0.1706 lr=1.74e-05 elapsed=1.06 min
[train] step 8700/9155 train_loss=0.2897 lr=1.57e-05 elapsed=1.07 min
[train] step 8750/9155 train_loss=0.3106 lr=1.40e-05 elapsed=1.07 min
[train] step 8800/9155 train_loss=0.2278 lr=1.22e-05 elapsed=1.08 min
[train] step 8850/9155 train_loss=0.2550 lr=1.05e-05 elapsed=1.08 min
[train] step 8900/9155 train_loss=0.2389 lr=8.80e-06 elapsed=1.09 min
[train] step 8950/9155 train_loss=0.2782 lr=7.07e-06 elapsed=1.09 min
[train] step 9000/9155 train_loss=0.1790 lr=5.35e-06 elapsed=1.10 min
[eval] step 9000 val_loss=1.0875
[train] step 9050/9155 train_loss=0.2625 lr=3.62e-06 elapsed=1.11 min
[train] step 9100/9155 train_loss=0.2189 lr=1.90e-06 elapsed=1.12 min
[train] step 9150/9155 train_loss=0.3356 lr=1.72e-07 elapsed=1.12 min
[eval] step 9154 val_loss=1.0919
[train] Done. Total training time (one epoch): 1.13 minutes
[train] Peak GPU memory allocated: 0.70 GB
[ckpt] Saved final model to /scratch/dk5288/models2/abc_scaling/tiny_final.pt
[logs] Saved training logs to /scratch/dk5288/models2/abc_scaling/tiny_train_logs.json
[logs] Saved summary to /scratch/dk5288/models2/abc_scaling/tiny_summary.txt
[train] Training script finished cleanly.
Finished tiny
==============================
Starting training for small
==============================
/scratch/dk5288/envs/cv6643/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:182: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:106: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
[train] Starting training for model_size=small
[train] Output directory: /scratch/dk5288/models2/abc_scaling
[train] Using device: cuda
[train] Vocab size: 99
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/train.txt (max_chars=150000000)
[load_text] Loaded 150000000 characters
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/val.txt (max_chars=5000000)
[load_text] Loaded 5000000 characters
[encode_text] Encoding text to ids...
[encode_text] Encoded 150000000 tokens
[encode_text] Encoding text to ids...
[encode_text] Encoded 5000000 tokens
[train] tokens_per_step = 16384
[train] max_steps (one epoch over ~150000000 tokens) = 9155
[get_model_config] Built config 'small' (layers=6, heads=8, emb=256, block_size=256, vocab_size=99)
[GPT] Initialized model: layers=6, heads=8, emb=256, block_size=256, params=4.82M
[train] Model small has 4823808 parameters (4.82M)
[train] Beginning training loop...
[train] step 0/9155 train_loss=4.7075 lr=6.56e-07 elapsed=0.01 min
[eval] step 0 val_loss=4.6732
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 50/9155 train_loss=3.2124 lr=3.35e-05 elapsed=0.04 min
[train] step 100/9155 train_loss=1.2748 lr=6.63e-05 elapsed=0.05 min
[train] step 150/9155 train_loss=0.8477 lr=9.91e-05 elapsed=0.06 min
[train] step 200/9155 train_loss=0.5528 lr=1.32e-04 elapsed=0.07 min
[train] step 250/9155 train_loss=0.6263 lr=1.65e-04 elapsed=0.09 min
[train] step 300/9155 train_loss=0.5766 lr=1.98e-04 elapsed=0.10 min
[train] step 350/9155 train_loss=0.5566 lr=2.30e-04 elapsed=0.11 min
[train] step 400/9155 train_loss=0.4281 lr=2.63e-04 elapsed=0.12 min
[train] step 450/9155 train_loss=0.4427 lr=2.96e-04 elapsed=0.14 min
[train] step 500/9155 train_loss=0.3450 lr=2.99e-04 elapsed=0.15 min
[eval] step 500 val_loss=1.4954
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 550/9155 train_loss=0.3960 lr=2.97e-04 elapsed=0.18 min
[train] step 600/9155 train_loss=0.2961 lr=2.95e-04 elapsed=0.19 min
[train] step 650/9155 train_loss=0.4048 lr=2.93e-04 elapsed=0.21 min
[train] step 700/9155 train_loss=0.3183 lr=2.92e-04 elapsed=0.22 min
[train] step 750/9155 train_loss=0.3809 lr=2.90e-04 elapsed=0.23 min
[train] step 800/9155 train_loss=0.3010 lr=2.88e-04 elapsed=0.24 min
[train] step 850/9155 train_loss=0.3859 lr=2.86e-04 elapsed=0.26 min
[train] step 900/9155 train_loss=0.3010 lr=2.85e-04 elapsed=0.27 min
[train] step 950/9155 train_loss=0.3235 lr=2.83e-04 elapsed=0.28 min
[train] step 1000/9155 train_loss=0.3221 lr=2.81e-04 elapsed=0.29 min
[eval] step 1000 val_loss=1.3820
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 1050/9155 train_loss=0.4523 lr=2.80e-04 elapsed=0.33 min
[train] step 1100/9155 train_loss=0.1327 lr=2.78e-04 elapsed=0.34 min
[train] step 1150/9155 train_loss=0.2335 lr=2.76e-04 elapsed=0.35 min
[train] step 1200/9155 train_loss=0.2592 lr=2.74e-04 elapsed=0.36 min
[train] step 1250/9155 train_loss=0.3127 lr=2.73e-04 elapsed=0.38 min
[train] step 1300/9155 train_loss=0.2796 lr=2.71e-04 elapsed=0.39 min
[train] step 1350/9155 train_loss=0.2739 lr=2.69e-04 elapsed=0.40 min
[train] step 1400/9155 train_loss=0.3061 lr=2.67e-04 elapsed=0.41 min
[train] step 1450/9155 train_loss=0.2694 lr=2.66e-04 elapsed=0.43 min
[train] step 1500/9155 train_loss=0.2478 lr=2.64e-04 elapsed=0.44 min
[eval] step 1500 val_loss=1.2401
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 1550/9155 train_loss=0.3011 lr=2.62e-04 elapsed=0.47 min
[train] step 1600/9155 train_loss=0.2220 lr=2.61e-04 elapsed=0.48 min
[train] step 1650/9155 train_loss=0.1876 lr=2.59e-04 elapsed=0.49 min
[train] step 1700/9155 train_loss=0.3147 lr=2.57e-04 elapsed=0.51 min
[train] step 1750/9155 train_loss=0.2530 lr=2.55e-04 elapsed=0.52 min
[train] step 1800/9155 train_loss=0.3577 lr=2.54e-04 elapsed=0.53 min
[train] step 1850/9155 train_loss=0.4308 lr=2.52e-04 elapsed=0.54 min
[train] step 1900/9155 train_loss=0.3181 lr=2.50e-04 elapsed=0.56 min
[train] step 1950/9155 train_loss=0.2798 lr=2.49e-04 elapsed=0.57 min
[train] step 2000/9155 train_loss=0.3776 lr=2.47e-04 elapsed=0.58 min
[eval] step 2000 val_loss=1.1906
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 2050/9155 train_loss=0.2643 lr=2.45e-04 elapsed=0.61 min
[train] step 2100/9155 train_loss=0.2050 lr=2.43e-04 elapsed=0.63 min
[train] step 2150/9155 train_loss=0.2501 lr=2.42e-04 elapsed=0.64 min
[train] step 2200/9155 train_loss=0.1928 lr=2.40e-04 elapsed=0.65 min
[train] step 2250/9155 train_loss=0.2556 lr=2.38e-04 elapsed=0.66 min
[train] step 2300/9155 train_loss=0.2501 lr=2.36e-04 elapsed=0.68 min
[train] step 2350/9155 train_loss=0.2885 lr=2.35e-04 elapsed=0.69 min
[train] step 2400/9155 train_loss=0.2261 lr=2.33e-04 elapsed=0.70 min
[train] step 2450/9155 train_loss=0.1862 lr=2.31e-04 elapsed=0.71 min
[train] step 2500/9155 train_loss=0.2637 lr=2.30e-04 elapsed=0.73 min
[eval] step 2500 val_loss=1.1004
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 2550/9155 train_loss=0.2514 lr=2.28e-04 elapsed=0.76 min
[train] step 2600/9155 train_loss=0.3735 lr=2.26e-04 elapsed=0.77 min
[train] step 2650/9155 train_loss=0.1887 lr=2.24e-04 elapsed=0.78 min
[train] step 2700/9155 train_loss=0.2383 lr=2.23e-04 elapsed=0.80 min
[train] step 2750/9155 train_loss=0.3193 lr=2.21e-04 elapsed=0.81 min
[train] step 2800/9155 train_loss=0.2854 lr=2.19e-04 elapsed=0.82 min
[train] step 2850/9155 train_loss=0.2948 lr=2.17e-04 elapsed=0.83 min
[train] step 2900/9155 train_loss=0.2090 lr=2.16e-04 elapsed=0.85 min
[train] step 2950/9155 train_loss=0.2247 lr=2.14e-04 elapsed=0.86 min
[train] step 3000/9155 train_loss=0.2611 lr=2.12e-04 elapsed=0.87 min
[eval] step 3000 val_loss=1.0553
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 3050/9155 train_loss=0.1598 lr=2.11e-04 elapsed=0.90 min
[train] step 3100/9155 train_loss=0.2169 lr=2.09e-04 elapsed=0.91 min
[train] step 3150/9155 train_loss=0.1939 lr=2.07e-04 elapsed=0.93 min
[train] step 3200/9155 train_loss=0.1627 lr=2.05e-04 elapsed=0.94 min
[train] step 3250/9155 train_loss=0.2631 lr=2.04e-04 elapsed=0.95 min
[train] step 3300/9155 train_loss=0.1900 lr=2.02e-04 elapsed=0.96 min
[train] step 3350/9155 train_loss=0.2477 lr=2.00e-04 elapsed=0.98 min
[train] step 3400/9155 train_loss=0.2643 lr=1.98e-04 elapsed=0.99 min
[train] step 3450/9155 train_loss=0.2444 lr=1.97e-04 elapsed=1.00 min
[train] step 3500/9155 train_loss=0.2419 lr=1.95e-04 elapsed=1.02 min
[eval] step 3500 val_loss=1.0233
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 3550/9155 train_loss=0.3123 lr=1.93e-04 elapsed=1.05 min
[train] step 3600/9155 train_loss=0.3077 lr=1.92e-04 elapsed=1.06 min
[train] step 3650/9155 train_loss=0.2521 lr=1.90e-04 elapsed=1.07 min
[train] step 3700/9155 train_loss=0.1948 lr=1.88e-04 elapsed=1.08 min
[train] step 3750/9155 train_loss=0.4008 lr=1.86e-04 elapsed=1.10 min
[train] step 3800/9155 train_loss=0.1790 lr=1.85e-04 elapsed=1.11 min
[train] step 3850/9155 train_loss=0.1268 lr=1.83e-04 elapsed=1.12 min
[train] step 3900/9155 train_loss=0.2477 lr=1.81e-04 elapsed=1.13 min
[train] step 3950/9155 train_loss=0.1273 lr=1.80e-04 elapsed=1.15 min
[train] step 4000/9155 train_loss=0.2324 lr=1.78e-04 elapsed=1.16 min
[eval] step 4000 val_loss=0.9885
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 4050/9155 train_loss=0.2491 lr=1.76e-04 elapsed=1.19 min
[train] step 4100/9155 train_loss=0.3362 lr=1.74e-04 elapsed=1.20 min
[train] step 4150/9155 train_loss=0.2788 lr=1.73e-04 elapsed=1.22 min
[train] step 4200/9155 train_loss=0.3076 lr=1.71e-04 elapsed=1.23 min
[train] step 4250/9155 train_loss=0.3428 lr=1.69e-04 elapsed=1.24 min
[train] step 4300/9155 train_loss=0.3151 lr=1.67e-04 elapsed=1.25 min
[train] step 4350/9155 train_loss=0.1974 lr=1.66e-04 elapsed=1.27 min
[train] step 4400/9155 train_loss=0.1911 lr=1.64e-04 elapsed=1.28 min
[train] step 4450/9155 train_loss=0.2283 lr=1.62e-04 elapsed=1.29 min
[train] step 4500/9155 train_loss=0.2577 lr=1.61e-04 elapsed=1.30 min
[eval] step 4500 val_loss=0.9542
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 4550/9155 train_loss=0.2265 lr=1.59e-04 elapsed=1.34 min
[train] step 4600/9155 train_loss=0.1150 lr=1.57e-04 elapsed=1.35 min
[train] step 4650/9155 train_loss=0.3011 lr=1.55e-04 elapsed=1.36 min
[train] step 4700/9155 train_loss=0.2387 lr=1.54e-04 elapsed=1.37 min
[train] step 4750/9155 train_loss=0.1827 lr=1.52e-04 elapsed=1.39 min
[train] step 4800/9155 train_loss=0.2455 lr=1.50e-04 elapsed=1.40 min
[train] step 4850/9155 train_loss=0.1939 lr=1.48e-04 elapsed=1.41 min
[train] step 4900/9155 train_loss=0.1909 lr=1.47e-04 elapsed=1.42 min
[train] step 4950/9155 train_loss=0.1976 lr=1.45e-04 elapsed=1.44 min
[train] step 5000/9155 train_loss=0.1784 lr=1.43e-04 elapsed=1.45 min
[eval] step 5000 val_loss=0.9395
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 5050/9155 train_loss=0.2371 lr=1.42e-04 elapsed=1.48 min
[train] step 5100/9155 train_loss=0.1605 lr=1.40e-04 elapsed=1.49 min
[train] step 5150/9155 train_loss=0.2873 lr=1.38e-04 elapsed=1.50 min
[train] step 5200/9155 train_loss=0.2614 lr=1.36e-04 elapsed=1.52 min
[train] step 5250/9155 train_loss=0.1474 lr=1.35e-04 elapsed=1.53 min
[train] step 5300/9155 train_loss=0.2120 lr=1.33e-04 elapsed=1.54 min
[train] step 5350/9155 train_loss=0.2189 lr=1.31e-04 elapsed=1.55 min
[train] step 5400/9155 train_loss=0.2900 lr=1.30e-04 elapsed=1.57 min
[train] step 5450/9155 train_loss=0.1677 lr=1.28e-04 elapsed=1.58 min
[train] step 5500/9155 train_loss=0.1399 lr=1.26e-04 elapsed=1.59 min
[eval] step 5500 val_loss=0.9320
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 5550/9155 train_loss=0.2459 lr=1.24e-04 elapsed=1.62 min
[train] step 5600/9155 train_loss=0.2714 lr=1.23e-04 elapsed=1.64 min
[train] step 5650/9155 train_loss=0.2170 lr=1.21e-04 elapsed=1.65 min
[train] step 5700/9155 train_loss=0.2388 lr=1.19e-04 elapsed=1.66 min
[train] step 5750/9155 train_loss=0.2850 lr=1.17e-04 elapsed=1.67 min
[train] step 5800/9155 train_loss=0.3120 lr=1.16e-04 elapsed=1.69 min
[train] step 5850/9155 train_loss=0.1498 lr=1.14e-04 elapsed=1.70 min
[train] step 5900/9155 train_loss=0.2893 lr=1.12e-04 elapsed=1.71 min
[train] step 5950/9155 train_loss=0.1628 lr=1.11e-04 elapsed=1.72 min
[train] step 6000/9155 train_loss=0.1791 lr=1.09e-04 elapsed=1.74 min
[eval] step 6000 val_loss=0.9212
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 6050/9155 train_loss=0.2172 lr=1.07e-04 elapsed=1.77 min
[train] step 6100/9155 train_loss=0.2138 lr=1.05e-04 elapsed=1.78 min
[train] step 6150/9155 train_loss=0.1867 lr=1.04e-04 elapsed=1.79 min
[train] step 6200/9155 train_loss=0.3059 lr=1.02e-04 elapsed=1.80 min
[train] step 6250/9155 train_loss=0.2182 lr=1.00e-04 elapsed=1.82 min
[train] step 6300/9155 train_loss=0.2240 lr=9.85e-05 elapsed=1.83 min
[train] step 6350/9155 train_loss=0.1955 lr=9.67e-05 elapsed=1.84 min
[train] step 6400/9155 train_loss=0.2201 lr=9.50e-05 elapsed=1.85 min
[train] step 6450/9155 train_loss=0.1854 lr=9.33e-05 elapsed=1.87 min
[train] step 6500/9155 train_loss=0.2325 lr=9.16e-05 elapsed=1.88 min
[eval] step 6500 val_loss=0.9074
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 6550/9155 train_loss=0.2857 lr=8.98e-05 elapsed=1.91 min
[train] step 6600/9155 train_loss=0.1308 lr=8.81e-05 elapsed=1.92 min
[train] step 6650/9155 train_loss=0.1574 lr=8.64e-05 elapsed=1.94 min
[train] step 6700/9155 train_loss=0.2658 lr=8.47e-05 elapsed=1.95 min
[train] step 6750/9155 train_loss=0.2287 lr=8.30e-05 elapsed=1.96 min
[train] step 6800/9155 train_loss=0.2083 lr=8.12e-05 elapsed=1.97 min
[train] step 6850/9155 train_loss=0.1984 lr=7.95e-05 elapsed=1.99 min
[train] step 6900/9155 train_loss=0.1925 lr=7.78e-05 elapsed=2.00 min
[train] step 6950/9155 train_loss=0.1905 lr=7.61e-05 elapsed=2.01 min
[train] step 7000/9155 train_loss=0.2540 lr=7.43e-05 elapsed=2.02 min
[eval] step 7000 val_loss=0.8998
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 7050/9155 train_loss=0.1291 lr=7.26e-05 elapsed=2.05 min
[train] step 7100/9155 train_loss=0.1284 lr=7.09e-05 elapsed=2.07 min
[train] step 7150/9155 train_loss=0.1927 lr=6.92e-05 elapsed=2.08 min
[train] step 7200/9155 train_loss=0.2098 lr=6.74e-05 elapsed=2.09 min
[train] step 7250/9155 train_loss=0.1849 lr=6.57e-05 elapsed=2.10 min
[train] step 7300/9155 train_loss=0.2097 lr=6.40e-05 elapsed=2.12 min
[train] step 7350/9155 train_loss=0.1613 lr=6.23e-05 elapsed=2.13 min
[train] step 7400/9155 train_loss=0.1675 lr=6.05e-05 elapsed=2.14 min
[train] step 7450/9155 train_loss=0.1122 lr=5.88e-05 elapsed=2.15 min
[train] step 7500/9155 train_loss=0.1629 lr=5.71e-05 elapsed=2.17 min
[eval] step 7500 val_loss=0.9011
[train] step 7550/9155 train_loss=0.2589 lr=5.54e-05 elapsed=2.20 min
[train] step 7600/9155 train_loss=0.2278 lr=5.36e-05 elapsed=2.21 min
[train] step 7650/9155 train_loss=0.2586 lr=5.19e-05 elapsed=2.22 min
[train] step 7700/9155 train_loss=0.2096 lr=5.02e-05 elapsed=2.24 min
[train] step 7750/9155 train_loss=0.2064 lr=4.85e-05 elapsed=2.25 min
[train] step 7800/9155 train_loss=0.2303 lr=4.67e-05 elapsed=2.26 min
[train] step 7850/9155 train_loss=0.1878 lr=4.50e-05 elapsed=2.27 min
[train] step 7900/9155 train_loss=0.1912 lr=4.33e-05 elapsed=2.29 min
[train] step 7950/9155 train_loss=0.2314 lr=4.16e-05 elapsed=2.30 min
[train] step 8000/9155 train_loss=0.2793 lr=3.98e-05 elapsed=2.31 min
[eval] step 8000 val_loss=0.9010
[train] step 8050/9155 train_loss=0.1643 lr=3.81e-05 elapsed=2.34 min
[train] step 8100/9155 train_loss=0.1555 lr=3.64e-05 elapsed=2.35 min
[train] step 8150/9155 train_loss=0.2760 lr=3.47e-05 elapsed=2.37 min
[train] step 8200/9155 train_loss=0.1677 lr=3.29e-05 elapsed=2.38 min
[train] step 8250/9155 train_loss=0.2255 lr=3.12e-05 elapsed=2.39 min
[train] step 8300/9155 train_loss=0.2276 lr=2.95e-05 elapsed=2.40 min
[train] step 8350/9155 train_loss=0.2278 lr=2.78e-05 elapsed=2.42 min
[train] step 8400/9155 train_loss=0.1611 lr=2.60e-05 elapsed=2.43 min
[train] step 8450/9155 train_loss=0.2128 lr=2.43e-05 elapsed=2.44 min
[train] step 8500/9155 train_loss=0.1903 lr=2.26e-05 elapsed=2.45 min
[eval] step 8500 val_loss=0.8974
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 8550/9155 train_loss=0.2047 lr=2.09e-05 elapsed=2.48 min
[train] step 8600/9155 train_loss=0.2373 lr=1.91e-05 elapsed=2.50 min
[train] step 8650/9155 train_loss=0.1634 lr=1.74e-05 elapsed=2.51 min
[train] step 8700/9155 train_loss=0.2938 lr=1.57e-05 elapsed=2.52 min
[train] step 8750/9155 train_loss=0.2300 lr=1.40e-05 elapsed=2.53 min
[train] step 8800/9155 train_loss=0.2525 lr=1.22e-05 elapsed=2.55 min
[train] step 8850/9155 train_loss=0.2676 lr=1.05e-05 elapsed=2.56 min
[train] step 8900/9155 train_loss=0.2130 lr=8.80e-06 elapsed=2.57 min
[train] step 8950/9155 train_loss=0.2259 lr=7.07e-06 elapsed=2.58 min
[train] step 9000/9155 train_loss=0.2720 lr=5.35e-06 elapsed=2.60 min
[eval] step 9000 val_loss=0.8910
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] step 9050/9155 train_loss=0.2865 lr=3.62e-06 elapsed=2.63 min
[train] step 9100/9155 train_loss=0.2431 lr=1.90e-06 elapsed=2.64 min
[train] step 9150/9155 train_loss=0.1361 lr=1.72e-07 elapsed=2.65 min
[eval] step 9154 val_loss=0.8896
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/small_best.pt
[train] Done. Total training time (one epoch): 2.67 minutes
[train] Peak GPU memory allocated: 2.27 GB
[ckpt] Saved final model to /scratch/dk5288/models2/abc_scaling/small_final.pt
[logs] Saved training logs to /scratch/dk5288/models2/abc_scaling/small_train_logs.json
[logs] Saved summary to /scratch/dk5288/models2/abc_scaling/small_summary.txt
[train] Training script finished cleanly.
Finished small
==============================
Starting training for medium
==============================
/scratch/dk5288/envs/cv6643/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:182: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:106: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
[train] Starting training for model_size=medium
[train] Output directory: /scratch/dk5288/models2/abc_scaling
[train] Using device: cuda
[train] Vocab size: 99
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/train.txt (max_chars=150000000)
[load_text] Loaded 150000000 characters
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/val.txt (max_chars=5000000)
[load_text] Loaded 5000000 characters
[encode_text] Encoding text to ids...
[encode_text] Encoded 150000000 tokens
[encode_text] Encoding text to ids...
[encode_text] Encoded 5000000 tokens
[train] tokens_per_step = 16384
[train] max_steps (one epoch over ~150000000 tokens) = 9155
[get_model_config] Built config 'medium' (layers=8, heads=8, emb=448, block_size=256, vocab_size=99)
[GPT] Initialized model: layers=8, heads=8, emb=448, block_size=256, params=19.46M
[train] Model medium has 19459776 parameters (19.46M)
[train] Beginning training loop...
[train] step 0/9155 train_loss=4.6860 lr=6.56e-07 elapsed=0.01 min
[eval] step 0 val_loss=4.5717
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 50/9155 train_loss=2.3624 lr=3.35e-05 elapsed=0.06 min
[train] step 100/9155 train_loss=0.6478 lr=6.63e-05 elapsed=0.08 min
[train] step 150/9155 train_loss=0.6713 lr=9.91e-05 elapsed=0.10 min
[train] step 200/9155 train_loss=0.3241 lr=1.32e-04 elapsed=0.12 min
[train] step 250/9155 train_loss=0.4901 lr=1.65e-04 elapsed=0.14 min
[train] step 300/9155 train_loss=0.2358 lr=1.98e-04 elapsed=0.16 min
[train] step 350/9155 train_loss=0.4534 lr=2.30e-04 elapsed=0.18 min
[train] step 400/9155 train_loss=0.4139 lr=2.63e-04 elapsed=0.20 min
[train] step 450/9155 train_loss=0.3532 lr=2.96e-04 elapsed=0.22 min
[train] step 500/9155 train_loss=0.2930 lr=2.99e-04 elapsed=0.24 min
[eval] step 500 val_loss=1.4629
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 550/9155 train_loss=0.4436 lr=2.97e-04 elapsed=0.29 min
[train] step 600/9155 train_loss=0.4431 lr=2.95e-04 elapsed=0.31 min
[train] step 650/9155 train_loss=0.3846 lr=2.93e-04 elapsed=0.33 min
[train] step 700/9155 train_loss=0.3517 lr=2.92e-04 elapsed=0.35 min
[train] step 750/9155 train_loss=0.4699 lr=2.90e-04 elapsed=0.37 min
[train] step 800/9155 train_loss=0.3457 lr=2.88e-04 elapsed=0.39 min
[train] step 850/9155 train_loss=0.3451 lr=2.86e-04 elapsed=0.41 min
[train] step 900/9155 train_loss=0.3980 lr=2.85e-04 elapsed=0.43 min
[train] step 950/9155 train_loss=0.4574 lr=2.83e-04 elapsed=0.45 min
[train] step 1000/9155 train_loss=0.1766 lr=2.81e-04 elapsed=0.47 min
[eval] step 1000 val_loss=1.2776
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 1050/9155 train_loss=0.3603 lr=2.80e-04 elapsed=0.53 min
[train] step 1100/9155 train_loss=0.3202 lr=2.78e-04 elapsed=0.55 min
[train] step 1150/9155 train_loss=0.2807 lr=2.76e-04 elapsed=0.57 min
[train] step 1200/9155 train_loss=0.2544 lr=2.74e-04 elapsed=0.59 min
[train] step 1250/9155 train_loss=0.2092 lr=2.73e-04 elapsed=0.61 min
[train] step 1300/9155 train_loss=0.3101 lr=2.71e-04 elapsed=0.63 min
[train] step 1350/9155 train_loss=0.2190 lr=2.69e-04 elapsed=0.65 min
[train] step 1400/9155 train_loss=0.2993 lr=2.67e-04 elapsed=0.67 min
[train] step 1450/9155 train_loss=0.2704 lr=2.66e-04 elapsed=0.69 min
[train] step 1500/9155 train_loss=0.2751 lr=2.64e-04 elapsed=0.71 min
[eval] step 1500 val_loss=1.1831
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 1550/9155 train_loss=0.3076 lr=2.62e-04 elapsed=0.76 min
[train] step 1600/9155 train_loss=0.2843 lr=2.61e-04 elapsed=0.78 min
[train] step 1650/9155 train_loss=0.2190 lr=2.59e-04 elapsed=0.80 min
[train] step 1700/9155 train_loss=0.2087 lr=2.57e-04 elapsed=0.82 min
[train] step 1750/9155 train_loss=0.2017 lr=2.55e-04 elapsed=0.84 min
[train] step 1800/9155 train_loss=0.1607 lr=2.54e-04 elapsed=0.86 min
[train] step 1850/9155 train_loss=0.2937 lr=2.52e-04 elapsed=0.88 min
[train] step 1900/9155 train_loss=0.2491 lr=2.50e-04 elapsed=0.90 min
[train] step 1950/9155 train_loss=0.1646 lr=2.49e-04 elapsed=0.92 min
[train] step 2000/9155 train_loss=0.3002 lr=2.47e-04 elapsed=0.94 min
[eval] step 2000 val_loss=1.1142
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 2050/9155 train_loss=0.2847 lr=2.45e-04 elapsed=0.99 min
[train] step 2100/9155 train_loss=0.2507 lr=2.43e-04 elapsed=1.01 min
[train] step 2150/9155 train_loss=0.2902 lr=2.42e-04 elapsed=1.03 min
[train] step 2200/9155 train_loss=0.3329 lr=2.40e-04 elapsed=1.05 min
[train] step 2250/9155 train_loss=0.3087 lr=2.38e-04 elapsed=1.07 min
[train] step 2300/9155 train_loss=0.2998 lr=2.36e-04 elapsed=1.09 min
[train] step 2350/9155 train_loss=0.2100 lr=2.35e-04 elapsed=1.11 min
[train] step 2400/9155 train_loss=0.2072 lr=2.33e-04 elapsed=1.14 min
[train] step 2450/9155 train_loss=0.2228 lr=2.31e-04 elapsed=1.16 min
[train] step 2500/9155 train_loss=0.1888 lr=2.30e-04 elapsed=1.18 min
[eval] step 2500 val_loss=1.0073
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 2550/9155 train_loss=0.3016 lr=2.28e-04 elapsed=1.23 min
[train] step 2600/9155 train_loss=0.1872 lr=2.26e-04 elapsed=1.25 min
[train] step 2650/9155 train_loss=0.3092 lr=2.24e-04 elapsed=1.27 min
[train] step 2700/9155 train_loss=0.2639 lr=2.23e-04 elapsed=1.29 min
[train] step 2750/9155 train_loss=0.2345 lr=2.21e-04 elapsed=1.31 min
[train] step 2800/9155 train_loss=0.1866 lr=2.19e-04 elapsed=1.33 min
[train] step 2850/9155 train_loss=0.2518 lr=2.17e-04 elapsed=1.35 min
[train] step 2900/9155 train_loss=0.2293 lr=2.16e-04 elapsed=1.37 min
[train] step 2950/9155 train_loss=0.1405 lr=2.14e-04 elapsed=1.39 min
[train] step 3000/9155 train_loss=0.1753 lr=2.12e-04 elapsed=1.41 min
[eval] step 3000 val_loss=0.9613
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 3050/9155 train_loss=0.2436 lr=2.11e-04 elapsed=1.46 min
[train] step 3100/9155 train_loss=0.2683 lr=2.09e-04 elapsed=1.48 min
[train] step 3150/9155 train_loss=0.1715 lr=2.07e-04 elapsed=1.50 min
[train] step 3200/9155 train_loss=0.2183 lr=2.05e-04 elapsed=1.52 min
[train] step 3250/9155 train_loss=0.3198 lr=2.04e-04 elapsed=1.54 min
[train] step 3300/9155 train_loss=0.2754 lr=2.02e-04 elapsed=1.56 min
[train] step 3350/9155 train_loss=0.2766 lr=2.00e-04 elapsed=1.58 min
[train] step 3400/9155 train_loss=0.2131 lr=1.98e-04 elapsed=1.60 min
[train] step 3450/9155 train_loss=0.3207 lr=1.97e-04 elapsed=1.62 min
[train] step 3500/9155 train_loss=0.1768 lr=1.95e-04 elapsed=1.64 min
[eval] step 3500 val_loss=0.9159
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 3550/9155 train_loss=0.0720 lr=1.93e-04 elapsed=1.69 min
[train] step 3600/9155 train_loss=0.2361 lr=1.92e-04 elapsed=1.71 min
[train] step 3650/9155 train_loss=0.1472 lr=1.90e-04 elapsed=1.74 min
[train] step 3700/9155 train_loss=0.1626 lr=1.88e-04 elapsed=1.76 min
[train] step 3750/9155 train_loss=0.2104 lr=1.86e-04 elapsed=1.78 min
[train] step 3800/9155 train_loss=0.1910 lr=1.85e-04 elapsed=1.80 min
[train] step 3850/9155 train_loss=0.2290 lr=1.83e-04 elapsed=1.82 min
[train] step 3900/9155 train_loss=0.1786 lr=1.81e-04 elapsed=1.84 min
[train] step 3950/9155 train_loss=0.1840 lr=1.80e-04 elapsed=1.86 min
[train] step 4000/9155 train_loss=0.1558 lr=1.78e-04 elapsed=1.88 min
[eval] step 4000 val_loss=0.8839
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 4050/9155 train_loss=0.1245 lr=1.76e-04 elapsed=1.93 min
[train] step 4100/9155 train_loss=0.1533 lr=1.74e-04 elapsed=1.95 min
[train] step 4150/9155 train_loss=0.2134 lr=1.73e-04 elapsed=1.97 min
[train] step 4200/9155 train_loss=0.2264 lr=1.71e-04 elapsed=1.99 min
[train] step 4250/9155 train_loss=0.2065 lr=1.69e-04 elapsed=2.01 min
[train] step 4300/9155 train_loss=0.1958 lr=1.67e-04 elapsed=2.03 min
[train] step 4350/9155 train_loss=0.1737 lr=1.66e-04 elapsed=2.05 min
[train] step 4400/9155 train_loss=0.2563 lr=1.64e-04 elapsed=2.07 min
[train] step 4450/9155 train_loss=0.1506 lr=1.62e-04 elapsed=2.09 min
[train] step 4500/9155 train_loss=0.1283 lr=1.61e-04 elapsed=2.11 min
[eval] step 4500 val_loss=0.8488
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 4550/9155 train_loss=0.2622 lr=1.59e-04 elapsed=2.16 min
[train] step 4600/9155 train_loss=0.2405 lr=1.57e-04 elapsed=2.18 min
[train] step 4650/9155 train_loss=0.2256 lr=1.55e-04 elapsed=2.20 min
[train] step 4700/9155 train_loss=0.2064 lr=1.54e-04 elapsed=2.22 min
[train] step 4750/9155 train_loss=0.2236 lr=1.52e-04 elapsed=2.24 min
[train] step 4800/9155 train_loss=0.2108 lr=1.50e-04 elapsed=2.26 min
[train] step 4850/9155 train_loss=0.2449 lr=1.48e-04 elapsed=2.28 min
[train] step 4900/9155 train_loss=0.2731 lr=1.47e-04 elapsed=2.30 min
[train] step 4950/9155 train_loss=0.1894 lr=1.45e-04 elapsed=2.32 min
[train] step 5000/9155 train_loss=0.1400 lr=1.43e-04 elapsed=2.34 min
[eval] step 5000 val_loss=0.8322
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 5050/9155 train_loss=0.1939 lr=1.42e-04 elapsed=2.40 min
[train] step 5100/9155 train_loss=0.1722 lr=1.40e-04 elapsed=2.42 min
[train] step 5150/9155 train_loss=0.2831 lr=1.38e-04 elapsed=2.44 min
[train] step 5200/9155 train_loss=0.2107 lr=1.36e-04 elapsed=2.46 min
[train] step 5250/9155 train_loss=0.1803 lr=1.35e-04 elapsed=2.48 min
[train] step 5300/9155 train_loss=0.2988 lr=1.33e-04 elapsed=2.50 min
[train] step 5350/9155 train_loss=0.2190 lr=1.31e-04 elapsed=2.52 min
[train] step 5400/9155 train_loss=0.1576 lr=1.30e-04 elapsed=2.54 min
[train] step 5450/9155 train_loss=0.1015 lr=1.28e-04 elapsed=2.56 min
[train] step 5500/9155 train_loss=0.2063 lr=1.26e-04 elapsed=2.58 min
[eval] step 5500 val_loss=0.8147
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 5550/9155 train_loss=0.1594 lr=1.24e-04 elapsed=2.63 min
[train] step 5600/9155 train_loss=0.1664 lr=1.23e-04 elapsed=2.65 min
[train] step 5650/9155 train_loss=0.1726 lr=1.21e-04 elapsed=2.67 min
[train] step 5700/9155 train_loss=0.1085 lr=1.19e-04 elapsed=2.69 min
[train] step 5750/9155 train_loss=0.1254 lr=1.17e-04 elapsed=2.71 min
[train] step 5800/9155 train_loss=0.1592 lr=1.16e-04 elapsed=2.73 min
[train] step 5850/9155 train_loss=0.1073 lr=1.14e-04 elapsed=2.75 min
[train] step 5900/9155 train_loss=0.1506 lr=1.12e-04 elapsed=2.77 min
[train] step 5950/9155 train_loss=0.2605 lr=1.11e-04 elapsed=2.79 min
[train] step 6000/9155 train_loss=0.1895 lr=1.09e-04 elapsed=2.81 min
[eval] step 6000 val_loss=0.8061
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 6050/9155 train_loss=0.1886 lr=1.07e-04 elapsed=2.86 min
[train] step 6100/9155 train_loss=0.2436 lr=1.05e-04 elapsed=2.88 min
[train] step 6150/9155 train_loss=0.1029 lr=1.04e-04 elapsed=2.90 min
[train] step 6200/9155 train_loss=0.2046 lr=1.02e-04 elapsed=2.92 min
[train] step 6250/9155 train_loss=0.1559 lr=1.00e-04 elapsed=2.94 min
[train] step 6300/9155 train_loss=0.2129 lr=9.85e-05 elapsed=2.96 min
[train] step 6350/9155 train_loss=0.1494 lr=9.67e-05 elapsed=2.98 min
[train] step 6400/9155 train_loss=0.2207 lr=9.50e-05 elapsed=3.00 min
[train] step 6450/9155 train_loss=0.2341 lr=9.33e-05 elapsed=3.02 min
[train] step 6500/9155 train_loss=0.1610 lr=9.16e-05 elapsed=3.04 min
[eval] step 6500 val_loss=0.7921
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 6550/9155 train_loss=0.2336 lr=8.98e-05 elapsed=3.10 min
[train] step 6600/9155 train_loss=0.1781 lr=8.81e-05 elapsed=3.12 min
[train] step 6650/9155 train_loss=0.2519 lr=8.64e-05 elapsed=3.14 min
[train] step 6700/9155 train_loss=0.1419 lr=8.47e-05 elapsed=3.16 min
[train] step 6750/9155 train_loss=0.1985 lr=8.30e-05 elapsed=3.18 min
[train] step 6800/9155 train_loss=0.1737 lr=8.12e-05 elapsed=3.20 min
[train] step 6850/9155 train_loss=0.1154 lr=7.95e-05 elapsed=3.22 min
[train] step 6900/9155 train_loss=0.1813 lr=7.78e-05 elapsed=3.24 min
[train] step 6950/9155 train_loss=0.2612 lr=7.61e-05 elapsed=3.26 min
[train] step 7000/9155 train_loss=0.2343 lr=7.43e-05 elapsed=3.28 min
[eval] step 7000 val_loss=0.7897
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 7050/9155 train_loss=0.2205 lr=7.26e-05 elapsed=3.33 min
[train] step 7100/9155 train_loss=0.1678 lr=7.09e-05 elapsed=3.35 min
[train] step 7150/9155 train_loss=0.1678 lr=6.92e-05 elapsed=3.37 min
[train] step 7200/9155 train_loss=0.1823 lr=6.74e-05 elapsed=3.39 min
[train] step 7250/9155 train_loss=0.2006 lr=6.57e-05 elapsed=3.41 min
[train] step 7300/9155 train_loss=0.2167 lr=6.40e-05 elapsed=3.43 min
[train] step 7350/9155 train_loss=0.1417 lr=6.23e-05 elapsed=3.45 min
[train] step 7400/9155 train_loss=0.2185 lr=6.05e-05 elapsed=3.47 min
[train] step 7450/9155 train_loss=0.2079 lr=5.88e-05 elapsed=3.49 min
[train] step 7500/9155 train_loss=0.1520 lr=5.71e-05 elapsed=3.51 min
[eval] step 7500 val_loss=0.7856
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 7550/9155 train_loss=0.2227 lr=5.54e-05 elapsed=3.56 min
[train] step 7600/9155 train_loss=0.1770 lr=5.36e-05 elapsed=3.58 min
[train] step 7650/9155 train_loss=0.2318 lr=5.19e-05 elapsed=3.60 min
[train] step 7700/9155 train_loss=0.1461 lr=5.02e-05 elapsed=3.62 min
[train] step 7750/9155 train_loss=0.2937 lr=4.85e-05 elapsed=3.64 min
[train] step 7800/9155 train_loss=0.2471 lr=4.67e-05 elapsed=3.66 min
[train] step 7850/9155 train_loss=0.1824 lr=4.50e-05 elapsed=3.68 min
[train] step 7900/9155 train_loss=0.1087 lr=4.33e-05 elapsed=3.71 min
[train] step 7950/9155 train_loss=0.1452 lr=4.16e-05 elapsed=3.73 min
[train] step 8000/9155 train_loss=0.2049 lr=3.98e-05 elapsed=3.75 min
[eval] step 8000 val_loss=0.7836
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 8050/9155 train_loss=0.1509 lr=3.81e-05 elapsed=3.80 min
[train] step 8100/9155 train_loss=0.1140 lr=3.64e-05 elapsed=3.82 min
[train] step 8150/9155 train_loss=0.2248 lr=3.47e-05 elapsed=3.84 min
[train] step 8200/9155 train_loss=0.2030 lr=3.29e-05 elapsed=3.86 min
[train] step 8250/9155 train_loss=0.1985 lr=3.12e-05 elapsed=3.88 min
[train] step 8300/9155 train_loss=0.1262 lr=2.95e-05 elapsed=3.90 min
[train] step 8350/9155 train_loss=0.1739 lr=2.78e-05 elapsed=3.92 min
[train] step 8400/9155 train_loss=0.1103 lr=2.60e-05 elapsed=3.94 min
[train] step 8450/9155 train_loss=0.2135 lr=2.43e-05 elapsed=3.96 min
[train] step 8500/9155 train_loss=0.1454 lr=2.26e-05 elapsed=3.98 min
[eval] step 8500 val_loss=0.7791
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 8550/9155 train_loss=0.1313 lr=2.09e-05 elapsed=4.03 min
[train] step 8600/9155 train_loss=0.1440 lr=1.91e-05 elapsed=4.05 min
[train] step 8650/9155 train_loss=0.1405 lr=1.74e-05 elapsed=4.07 min
[train] step 8700/9155 train_loss=0.1488 lr=1.57e-05 elapsed=4.09 min
[train] step 8750/9155 train_loss=0.2081 lr=1.40e-05 elapsed=4.11 min
[train] step 8800/9155 train_loss=0.1986 lr=1.22e-05 elapsed=4.13 min
[train] step 8850/9155 train_loss=0.2318 lr=1.05e-05 elapsed=4.15 min
[train] step 8900/9155 train_loss=0.1602 lr=8.80e-06 elapsed=4.17 min
[train] step 8950/9155 train_loss=0.1705 lr=7.07e-06 elapsed=4.19 min
[train] step 9000/9155 train_loss=0.1665 lr=5.35e-06 elapsed=4.21 min
[eval] step 9000 val_loss=0.7744
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] step 9050/9155 train_loss=0.3046 lr=3.62e-06 elapsed=4.26 min
[train] step 9100/9155 train_loss=0.1669 lr=1.90e-06 elapsed=4.28 min
[train] step 9150/9155 train_loss=0.2225 lr=1.72e-07 elapsed=4.30 min
[eval] step 9154 val_loss=0.7715
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/medium_best.pt
[train] Done. Total training time (one epoch): 4.34 minutes
[train] Peak GPU memory allocated: 3.95 GB
[ckpt] Saved final model to /scratch/dk5288/models2/abc_scaling/medium_final.pt
[logs] Saved training logs to /scratch/dk5288/models2/abc_scaling/medium_train_logs.json
[logs] Saved summary to /scratch/dk5288/models2/abc_scaling/medium_summary.txt
[train] Training script finished cleanly.
Finished medium
==============================
Starting training for large
==============================
/scratch/dk5288/envs/cv6643/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:182: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:106: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
[train] Starting training for model_size=large
[train] Output directory: /scratch/dk5288/models2/abc_scaling
[train] Using device: cuda
[train] Vocab size: 99
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/train.txt (max_chars=150000000)
[load_text] Loaded 150000000 characters
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/val.txt (max_chars=5000000)
[load_text] Loaded 5000000 characters
[encode_text] Encoding text to ids...
[encode_text] Encoded 150000000 tokens
[encode_text] Encoding text to ids...
[encode_text] Encoded 5000000 tokens
[train] tokens_per_step = 16384
[train] max_steps (one epoch over ~150000000 tokens) = 9155
[get_model_config] Built config 'large' (layers=10, heads=8, emb=640, block_size=256, vocab_size=99)
[GPT] Initialized model: layers=10, heads=8, emb=640, block_size=256, params=49.44M
[train] Model large has 49438080 parameters (49.44M)
[train] Beginning training loop...
[train] step 0/9155 train_loss=4.6806 lr=6.56e-07 elapsed=0.01 min
[eval] step 0 val_loss=4.7979
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 50/9155 train_loss=1.8697 lr=3.35e-05 elapsed=0.09 min
[train] step 100/9155 train_loss=0.7319 lr=6.63e-05 elapsed=0.12 min
[train] step 150/9155 train_loss=0.3794 lr=9.91e-05 elapsed=0.15 min
[train] step 200/9155 train_loss=0.5029 lr=1.32e-04 elapsed=0.18 min
[train] step 250/9155 train_loss=0.4697 lr=1.65e-04 elapsed=0.21 min
[train] step 300/9155 train_loss=0.2158 lr=1.98e-04 elapsed=0.24 min
[train] step 350/9155 train_loss=0.3847 lr=2.30e-04 elapsed=0.27 min
[train] step 400/9155 train_loss=0.5139 lr=2.63e-04 elapsed=0.30 min
[train] step 450/9155 train_loss=0.2795 lr=2.96e-04 elapsed=0.33 min
[train] step 500/9155 train_loss=0.3150 lr=2.99e-04 elapsed=0.37 min
[eval] step 500 val_loss=1.4577
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 550/9155 train_loss=0.4047 lr=2.97e-04 elapsed=0.44 min
[train] step 600/9155 train_loss=0.3978 lr=2.95e-04 elapsed=0.48 min
[train] step 650/9155 train_loss=0.3733 lr=2.93e-04 elapsed=0.51 min
[train] step 700/9155 train_loss=0.2092 lr=2.92e-04 elapsed=0.54 min
[train] step 750/9155 train_loss=0.2468 lr=2.90e-04 elapsed=0.57 min
[train] step 800/9155 train_loss=0.3000 lr=2.88e-04 elapsed=0.60 min
[train] step 850/9155 train_loss=0.2785 lr=2.86e-04 elapsed=0.63 min
[train] step 900/9155 train_loss=0.2704 lr=2.85e-04 elapsed=0.66 min
[train] step 950/9155 train_loss=0.3352 lr=2.83e-04 elapsed=0.69 min
[train] step 1000/9155 train_loss=0.3337 lr=2.81e-04 elapsed=0.72 min
[eval] step 1000 val_loss=1.2473
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 1050/9155 train_loss=0.2980 lr=2.80e-04 elapsed=0.80 min
[train] step 1100/9155 train_loss=0.2181 lr=2.78e-04 elapsed=0.83 min
[train] step 1150/9155 train_loss=0.3408 lr=2.76e-04 elapsed=0.87 min
[train] step 1200/9155 train_loss=0.2663 lr=2.74e-04 elapsed=0.90 min
[train] step 1250/9155 train_loss=0.3272 lr=2.73e-04 elapsed=0.93 min
[train] step 1300/9155 train_loss=0.2639 lr=2.71e-04 elapsed=0.96 min
[train] step 1350/9155 train_loss=0.2448 lr=2.69e-04 elapsed=0.99 min
[train] step 1400/9155 train_loss=0.2300 lr=2.67e-04 elapsed=1.02 min
[train] step 1450/9155 train_loss=0.3451 lr=2.66e-04 elapsed=1.05 min
[train] step 1500/9155 train_loss=0.2383 lr=2.64e-04 elapsed=1.08 min
[eval] step 1500 val_loss=1.1535
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 1550/9155 train_loss=0.2382 lr=2.62e-04 elapsed=1.16 min
[train] step 1600/9155 train_loss=0.2193 lr=2.61e-04 elapsed=1.19 min
[train] step 1650/9155 train_loss=0.2040 lr=2.59e-04 elapsed=1.22 min
[train] step 1700/9155 train_loss=0.3869 lr=2.57e-04 elapsed=1.26 min
[train] step 1750/9155 train_loss=0.1673 lr=2.55e-04 elapsed=1.29 min
[train] step 1800/9155 train_loss=0.2442 lr=2.54e-04 elapsed=1.32 min
[train] step 1850/9155 train_loss=0.2941 lr=2.52e-04 elapsed=1.35 min
[train] step 1900/9155 train_loss=0.2577 lr=2.50e-04 elapsed=1.38 min
[train] step 1950/9155 train_loss=0.1435 lr=2.49e-04 elapsed=1.41 min
[train] step 2000/9155 train_loss=0.2122 lr=2.47e-04 elapsed=1.44 min
[eval] step 2000 val_loss=1.0117
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 2050/9155 train_loss=0.2783 lr=2.45e-04 elapsed=1.52 min
[train] step 2100/9155 train_loss=0.2392 lr=2.43e-04 elapsed=1.55 min
[train] step 2150/9155 train_loss=0.2288 lr=2.42e-04 elapsed=1.58 min
[train] step 2200/9155 train_loss=0.3039 lr=2.40e-04 elapsed=1.61 min
[train] step 2250/9155 train_loss=0.2817 lr=2.38e-04 elapsed=1.65 min
[train] step 2300/9155 train_loss=0.2666 lr=2.36e-04 elapsed=1.68 min
[train] step 2350/9155 train_loss=0.2704 lr=2.35e-04 elapsed=1.71 min
[train] step 2400/9155 train_loss=0.1640 lr=2.33e-04 elapsed=1.74 min
[train] step 2450/9155 train_loss=0.2335 lr=2.31e-04 elapsed=1.77 min
[train] step 2500/9155 train_loss=0.2109 lr=2.30e-04 elapsed=1.80 min
[eval] step 2500 val_loss=0.9224
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 2550/9155 train_loss=0.1674 lr=2.28e-04 elapsed=1.88 min
[train] step 2600/9155 train_loss=0.2018 lr=2.26e-04 elapsed=1.91 min
[train] step 2650/9155 train_loss=0.2037 lr=2.24e-04 elapsed=1.94 min
[train] step 2700/9155 train_loss=0.2757 lr=2.23e-04 elapsed=1.97 min
[train] step 2750/9155 train_loss=0.2501 lr=2.21e-04 elapsed=2.00 min
[train] step 2800/9155 train_loss=0.2485 lr=2.19e-04 elapsed=2.04 min
[train] step 2850/9155 train_loss=0.2382 lr=2.17e-04 elapsed=2.07 min
[train] step 2900/9155 train_loss=0.1454 lr=2.16e-04 elapsed=2.10 min
[train] step 2950/9155 train_loss=0.2695 lr=2.14e-04 elapsed=2.13 min
[train] step 3000/9155 train_loss=0.2454 lr=2.12e-04 elapsed=2.16 min
[eval] step 3000 val_loss=0.8703
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 3050/9155 train_loss=0.2079 lr=2.11e-04 elapsed=2.24 min
[train] step 3100/9155 train_loss=0.1998 lr=2.09e-04 elapsed=2.27 min
[train] step 3150/9155 train_loss=0.1546 lr=2.07e-04 elapsed=2.30 min
[train] step 3200/9155 train_loss=0.1518 lr=2.05e-04 elapsed=2.33 min
[train] step 3250/9155 train_loss=0.1873 lr=2.04e-04 elapsed=2.36 min
[train] step 3300/9155 train_loss=0.2331 lr=2.02e-04 elapsed=2.39 min
[train] step 3350/9155 train_loss=0.1446 lr=2.00e-04 elapsed=2.43 min
[train] step 3400/9155 train_loss=0.1933 lr=1.98e-04 elapsed=2.46 min
[train] step 3450/9155 train_loss=0.2253 lr=1.97e-04 elapsed=2.49 min
[train] step 3500/9155 train_loss=0.1082 lr=1.95e-04 elapsed=2.52 min
[eval] step 3500 val_loss=0.8388
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 3550/9155 train_loss=0.1977 lr=1.93e-04 elapsed=2.60 min
[train] step 3600/9155 train_loss=0.1850 lr=1.92e-04 elapsed=2.63 min
[train] step 3650/9155 train_loss=0.2344 lr=1.90e-04 elapsed=2.66 min
[train] step 3700/9155 train_loss=0.2451 lr=1.88e-04 elapsed=2.69 min
[train] step 3750/9155 train_loss=0.1639 lr=1.86e-04 elapsed=2.72 min
[train] step 3800/9155 train_loss=0.2590 lr=1.85e-04 elapsed=2.75 min
[train] step 3850/9155 train_loss=0.1639 lr=1.83e-04 elapsed=2.78 min
[train] step 3900/9155 train_loss=0.2026 lr=1.81e-04 elapsed=2.82 min
[train] step 3950/9155 train_loss=0.3161 lr=1.80e-04 elapsed=2.85 min
[train] step 4000/9155 train_loss=0.1821 lr=1.78e-04 elapsed=2.88 min
[eval] step 4000 val_loss=0.8161
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 4050/9155 train_loss=0.1565 lr=1.76e-04 elapsed=2.96 min
[train] step 4100/9155 train_loss=0.1957 lr=1.74e-04 elapsed=2.99 min
[train] step 4150/9155 train_loss=0.1960 lr=1.73e-04 elapsed=3.02 min
[train] step 4200/9155 train_loss=0.1540 lr=1.71e-04 elapsed=3.05 min
[train] step 4250/9155 train_loss=0.2276 lr=1.69e-04 elapsed=3.08 min
[train] step 4300/9155 train_loss=0.2145 lr=1.67e-04 elapsed=3.11 min
[train] step 4350/9155 train_loss=0.1931 lr=1.66e-04 elapsed=3.14 min
[train] step 4400/9155 train_loss=0.1746 lr=1.64e-04 elapsed=3.17 min
[train] step 4450/9155 train_loss=0.2478 lr=1.62e-04 elapsed=3.21 min
[train] step 4500/9155 train_loss=0.2916 lr=1.61e-04 elapsed=3.24 min
[eval] step 4500 val_loss=0.7850
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 4550/9155 train_loss=0.2445 lr=1.59e-04 elapsed=3.32 min
[train] step 4600/9155 train_loss=0.2472 lr=1.57e-04 elapsed=3.35 min
[train] step 4650/9155 train_loss=0.1723 lr=1.55e-04 elapsed=3.38 min
[train] step 4700/9155 train_loss=0.1030 lr=1.54e-04 elapsed=3.41 min
[train] step 4750/9155 train_loss=0.1575 lr=1.52e-04 elapsed=3.44 min
[train] step 4800/9155 train_loss=0.1832 lr=1.50e-04 elapsed=3.47 min
[train] step 4850/9155 train_loss=0.2232 lr=1.48e-04 elapsed=3.50 min
[train] step 4900/9155 train_loss=0.2051 lr=1.47e-04 elapsed=3.53 min
[train] step 4950/9155 train_loss=0.2980 lr=1.45e-04 elapsed=3.56 min
[train] step 5000/9155 train_loss=0.2137 lr=1.43e-04 elapsed=3.60 min
[eval] step 5000 val_loss=0.7699
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 5050/9155 train_loss=0.2548 lr=1.42e-04 elapsed=3.67 min
[train] step 5100/9155 train_loss=0.1781 lr=1.40e-04 elapsed=3.71 min
[train] step 5150/9155 train_loss=0.2098 lr=1.38e-04 elapsed=3.74 min
[train] step 5200/9155 train_loss=0.2251 lr=1.36e-04 elapsed=3.77 min
[train] step 5250/9155 train_loss=0.1973 lr=1.35e-04 elapsed=3.80 min
[train] step 5300/9155 train_loss=0.2052 lr=1.33e-04 elapsed=3.83 min
[train] step 5350/9155 train_loss=0.1258 lr=1.31e-04 elapsed=3.86 min
[train] step 5400/9155 train_loss=0.1742 lr=1.30e-04 elapsed=3.89 min
[train] step 5450/9155 train_loss=0.1691 lr=1.28e-04 elapsed=3.92 min
[train] step 5500/9155 train_loss=0.1478 lr=1.26e-04 elapsed=3.95 min
[eval] step 5500 val_loss=0.7627
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 5550/9155 train_loss=0.1828 lr=1.24e-04 elapsed=4.03 min
[train] step 5600/9155 train_loss=0.0712 lr=1.23e-04 elapsed=4.06 min
[train] step 5650/9155 train_loss=0.1913 lr=1.21e-04 elapsed=4.10 min
[train] step 5700/9155 train_loss=0.1200 lr=1.19e-04 elapsed=4.13 min
[train] step 5750/9155 train_loss=0.1917 lr=1.17e-04 elapsed=4.16 min
[train] step 5800/9155 train_loss=0.1356 lr=1.16e-04 elapsed=4.19 min
[train] step 5850/9155 train_loss=0.1788 lr=1.14e-04 elapsed=4.22 min
[train] step 5900/9155 train_loss=0.1594 lr=1.12e-04 elapsed=4.25 min
[train] step 5950/9155 train_loss=0.1040 lr=1.11e-04 elapsed=4.28 min
[train] step 6000/9155 train_loss=0.2153 lr=1.09e-04 elapsed=4.31 min
[eval] step 6000 val_loss=0.7526
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 6050/9155 train_loss=0.1622 lr=1.07e-04 elapsed=4.39 min
[train] step 6100/9155 train_loss=0.0928 lr=1.05e-04 elapsed=4.42 min
[train] step 6150/9155 train_loss=0.1656 lr=1.04e-04 elapsed=4.45 min
[train] step 6200/9155 train_loss=0.1454 lr=1.02e-04 elapsed=4.49 min
[train] step 6250/9155 train_loss=0.1766 lr=1.00e-04 elapsed=4.52 min
[train] step 6300/9155 train_loss=0.1631 lr=9.85e-05 elapsed=4.55 min
[train] step 6350/9155 train_loss=0.2177 lr=9.67e-05 elapsed=4.58 min
[train] step 6400/9155 train_loss=0.1405 lr=9.50e-05 elapsed=4.61 min
[train] step 6450/9155 train_loss=0.2677 lr=9.33e-05 elapsed=4.64 min
[train] step 6500/9155 train_loss=0.1173 lr=9.16e-05 elapsed=4.67 min
[eval] step 6500 val_loss=0.7470
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 6550/9155 train_loss=0.1430 lr=8.98e-05 elapsed=4.75 min
[train] step 6600/9155 train_loss=0.2178 lr=8.81e-05 elapsed=4.78 min
[train] step 6650/9155 train_loss=0.2821 lr=8.64e-05 elapsed=4.81 min
[train] step 6700/9155 train_loss=0.1587 lr=8.47e-05 elapsed=4.84 min
[train] step 6750/9155 train_loss=0.2381 lr=8.30e-05 elapsed=4.88 min
[train] step 6800/9155 train_loss=0.1756 lr=8.12e-05 elapsed=4.91 min
[train] step 6850/9155 train_loss=0.1246 lr=7.95e-05 elapsed=4.94 min
[train] step 6900/9155 train_loss=0.1141 lr=7.78e-05 elapsed=4.97 min
[train] step 6950/9155 train_loss=0.1573 lr=7.61e-05 elapsed=5.00 min
[train] step 7000/9155 train_loss=0.0861 lr=7.43e-05 elapsed=5.03 min
[eval] step 7000 val_loss=0.7365
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 7050/9155 train_loss=0.2295 lr=7.26e-05 elapsed=5.11 min
[train] step 7100/9155 train_loss=0.1483 lr=7.09e-05 elapsed=5.14 min
[train] step 7150/9155 train_loss=0.1848 lr=6.92e-05 elapsed=5.17 min
[train] step 7200/9155 train_loss=0.2486 lr=6.74e-05 elapsed=5.20 min
[train] step 7250/9155 train_loss=0.1816 lr=6.57e-05 elapsed=5.23 min
[train] step 7300/9155 train_loss=0.1281 lr=6.40e-05 elapsed=5.26 min
[train] step 7350/9155 train_loss=0.1619 lr=6.23e-05 elapsed=5.30 min
[train] step 7400/9155 train_loss=0.1915 lr=6.05e-05 elapsed=5.33 min
[train] step 7450/9155 train_loss=0.1451 lr=5.88e-05 elapsed=5.36 min
[train] step 7500/9155 train_loss=0.1137 lr=5.71e-05 elapsed=5.39 min
[eval] step 7500 val_loss=0.7344
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 7550/9155 train_loss=0.2068 lr=5.54e-05 elapsed=5.47 min
[train] step 7600/9155 train_loss=0.0945 lr=5.36e-05 elapsed=5.50 min
[train] step 7650/9155 train_loss=0.1916 lr=5.19e-05 elapsed=5.53 min
[train] step 7700/9155 train_loss=0.1844 lr=5.02e-05 elapsed=5.56 min
[train] step 7750/9155 train_loss=0.1950 lr=4.85e-05 elapsed=5.59 min
[train] step 7800/9155 train_loss=0.1908 lr=4.67e-05 elapsed=5.62 min
[train] step 7850/9155 train_loss=0.1745 lr=4.50e-05 elapsed=5.65 min
[train] step 7900/9155 train_loss=0.1476 lr=4.33e-05 elapsed=5.68 min
[train] step 7950/9155 train_loss=0.1812 lr=4.16e-05 elapsed=5.72 min
[train] step 8000/9155 train_loss=0.1458 lr=3.98e-05 elapsed=5.75 min
[eval] step 8000 val_loss=0.7358
[train] step 8050/9155 train_loss=0.1560 lr=3.81e-05 elapsed=5.82 min
[train] step 8100/9155 train_loss=0.1974 lr=3.64e-05 elapsed=5.85 min
[train] step 8150/9155 train_loss=0.1053 lr=3.47e-05 elapsed=5.88 min
[train] step 8200/9155 train_loss=0.1270 lr=3.29e-05 elapsed=5.92 min
[train] step 8250/9155 train_loss=0.1619 lr=3.12e-05 elapsed=5.95 min
[train] step 8300/9155 train_loss=0.2007 lr=2.95e-05 elapsed=5.98 min
[train] step 8350/9155 train_loss=0.2049 lr=2.78e-05 elapsed=6.01 min
[train] step 8400/9155 train_loss=0.1854 lr=2.60e-05 elapsed=6.04 min
[train] step 8450/9155 train_loss=0.1119 lr=2.43e-05 elapsed=6.07 min
[train] step 8500/9155 train_loss=0.1380 lr=2.26e-05 elapsed=6.10 min
[eval] step 8500 val_loss=0.7336
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 8550/9155 train_loss=0.1144 lr=2.09e-05 elapsed=6.18 min
[train] step 8600/9155 train_loss=0.1128 lr=1.91e-05 elapsed=6.21 min
[train] step 8650/9155 train_loss=0.1916 lr=1.74e-05 elapsed=6.24 min
[train] step 8700/9155 train_loss=0.1827 lr=1.57e-05 elapsed=6.27 min
[train] step 8750/9155 train_loss=0.1945 lr=1.40e-05 elapsed=6.31 min
[train] step 8800/9155 train_loss=0.1637 lr=1.22e-05 elapsed=6.34 min
[train] step 8850/9155 train_loss=0.2059 lr=1.05e-05 elapsed=6.37 min
[train] step 8900/9155 train_loss=0.1208 lr=8.80e-06 elapsed=6.40 min
[train] step 8950/9155 train_loss=0.1804 lr=7.07e-06 elapsed=6.43 min
[train] step 9000/9155 train_loss=0.2010 lr=5.35e-06 elapsed=6.46 min
[eval] step 9000 val_loss=0.7261
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/large_best.pt
[train] step 9050/9155 train_loss=0.1801 lr=3.62e-06 elapsed=6.54 min
[train] step 9100/9155 train_loss=0.1422 lr=1.90e-06 elapsed=6.57 min
[train] step 9150/9155 train_loss=0.1880 lr=1.72e-07 elapsed=6.60 min
[eval] step 9154 val_loss=0.7315
[train] Done. Total training time (one epoch): 6.65 minutes
[train] Peak GPU memory allocated: 6.34 GB
[ckpt] Saved final model to /scratch/dk5288/models2/abc_scaling/large_final.pt
[logs] Saved training logs to /scratch/dk5288/models2/abc_scaling/large_train_logs.json
[logs] Saved summary to /scratch/dk5288/models2/abc_scaling/large_summary.txt
[train] Training script finished cleanly.
Finished large
==============================
Starting training for xl
==============================
/scratch/dk5288/envs/cv6643/lib64/python3.9/site-packages/networkx/utils/backends.py:135: RuntimeWarning: networkx backend defined more than once: nx-loopback
  backends.update(_get_backends("networkx.backends"))
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:182: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/scratch/dk5288/code/my_project/train_gpt_scaling2.py:106: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
[train] Starting training for model_size=xl
[train] Output directory: /scratch/dk5288/models2/abc_scaling
[train] Using device: cuda
[train] Vocab size: 99
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/train.txt (max_chars=150000000)
[load_text] Loaded 150000000 characters
[load_text] Loading from /scratch/dk5288/data/abc_char_corpus_98_1_1/val.txt (max_chars=5000000)
[load_text] Loaded 5000000 characters
[encode_text] Encoding text to ids...
[encode_text] Encoded 150000000 tokens
[encode_text] Encoding text to ids...
[encode_text] Encoded 5000000 tokens
[train] tokens_per_step = 16384
[train] max_steps (one epoch over ~150000000 tokens) = 9155
[get_model_config] Built config 'xl' (layers=12, heads=8, emb=832, block_size=256, vocab_size=99)
[GPT] Initialized model: layers=12, heads=8, emb=832, block_size=256, params=100.07M
[train] Model xl has 100067136 parameters (100.07M)
[train] Beginning training loop...
[train] step 0/9155 train_loss=4.6057 lr=6.56e-07 elapsed=0.01 min
[eval] step 0 val_loss=4.6847
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 50/9155 train_loss=1.3144 lr=3.35e-05 elapsed=0.12 min
[train] step 100/9155 train_loss=0.5581 lr=6.63e-05 elapsed=0.17 min
[train] step 150/9155 train_loss=0.5001 lr=9.91e-05 elapsed=0.22 min
[train] step 200/9155 train_loss=0.3873 lr=1.32e-04 elapsed=0.26 min
[train] step 250/9155 train_loss=0.6154 lr=1.65e-04 elapsed=0.31 min
[train] step 300/9155 train_loss=0.3860 lr=1.98e-04 elapsed=0.36 min
[train] step 350/9155 train_loss=0.3332 lr=2.30e-04 elapsed=0.40 min
[train] step 400/9155 train_loss=0.3036 lr=2.63e-04 elapsed=0.45 min
[train] step 450/9155 train_loss=0.4708 lr=2.96e-04 elapsed=0.49 min
[train] step 500/9155 train_loss=0.3313 lr=2.99e-04 elapsed=0.54 min
[eval] step 500 val_loss=1.4238
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 550/9155 train_loss=0.4034 lr=2.97e-04 elapsed=0.66 min
[train] step 600/9155 train_loss=0.3916 lr=2.95e-04 elapsed=0.71 min
[train] step 650/9155 train_loss=0.2951 lr=2.93e-04 elapsed=0.75 min
[train] step 700/9155 train_loss=0.4173 lr=2.92e-04 elapsed=0.80 min
[train] step 750/9155 train_loss=0.3123 lr=2.90e-04 elapsed=0.84 min
[train] step 800/9155 train_loss=0.3476 lr=2.88e-04 elapsed=0.89 min
[train] step 850/9155 train_loss=0.2210 lr=2.86e-04 elapsed=0.94 min
[train] step 900/9155 train_loss=0.1773 lr=2.85e-04 elapsed=0.98 min
[train] step 950/9155 train_loss=0.3630 lr=2.83e-04 elapsed=1.03 min
[train] step 1000/9155 train_loss=0.2364 lr=2.81e-04 elapsed=1.07 min
[eval] step 1000 val_loss=1.2385
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 1050/9155 train_loss=0.2698 lr=2.80e-04 elapsed=1.19 min
[train] step 1100/9155 train_loss=0.3267 lr=2.78e-04 elapsed=1.24 min
[train] step 1150/9155 train_loss=0.3966 lr=2.76e-04 elapsed=1.28 min
[train] step 1200/9155 train_loss=0.3216 lr=2.74e-04 elapsed=1.33 min
[train] step 1250/9155 train_loss=0.2207 lr=2.73e-04 elapsed=1.38 min
[train] step 1300/9155 train_loss=0.3506 lr=2.71e-04 elapsed=1.42 min
[train] step 1350/9155 train_loss=0.3279 lr=2.69e-04 elapsed=1.47 min
[train] step 1400/9155 train_loss=0.2707 lr=2.67e-04 elapsed=1.51 min
[train] step 1450/9155 train_loss=0.3085 lr=2.66e-04 elapsed=1.56 min
[train] step 1500/9155 train_loss=0.2301 lr=2.64e-04 elapsed=1.61 min
[eval] step 1500 val_loss=1.0736
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 1550/9155 train_loss=0.3429 lr=2.62e-04 elapsed=1.73 min
[train] step 1600/9155 train_loss=0.4287 lr=2.61e-04 elapsed=1.77 min
[train] step 1650/9155 train_loss=0.1973 lr=2.59e-04 elapsed=1.82 min
[train] step 1700/9155 train_loss=0.2163 lr=2.57e-04 elapsed=1.86 min
[train] step 1750/9155 train_loss=0.1834 lr=2.55e-04 elapsed=1.91 min
[train] step 1800/9155 train_loss=0.2021 lr=2.54e-04 elapsed=1.95 min
[train] step 1850/9155 train_loss=0.2348 lr=2.52e-04 elapsed=2.00 min
[train] step 1900/9155 train_loss=0.1403 lr=2.50e-04 elapsed=2.05 min
[train] step 1950/9155 train_loss=0.2311 lr=2.49e-04 elapsed=2.09 min
[train] step 2000/9155 train_loss=0.2086 lr=2.47e-04 elapsed=2.14 min
[eval] step 2000 val_loss=0.9246
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 2050/9155 train_loss=0.1399 lr=2.45e-04 elapsed=2.26 min
[train] step 2100/9155 train_loss=0.1570 lr=2.43e-04 elapsed=2.30 min
[train] step 2150/9155 train_loss=0.1317 lr=2.42e-04 elapsed=2.35 min
[train] step 2200/9155 train_loss=0.1805 lr=2.40e-04 elapsed=2.40 min
[train] step 2250/9155 train_loss=0.1642 lr=2.38e-04 elapsed=2.44 min
[train] step 2300/9155 train_loss=0.2461 lr=2.36e-04 elapsed=2.49 min
[train] step 2350/9155 train_loss=0.2378 lr=2.35e-04 elapsed=2.53 min
[train] step 2400/9155 train_loss=0.1410 lr=2.33e-04 elapsed=2.58 min
[train] step 2450/9155 train_loss=0.1884 lr=2.31e-04 elapsed=2.63 min
[train] step 2500/9155 train_loss=0.1405 lr=2.30e-04 elapsed=2.67 min
[eval] step 2500 val_loss=0.8462
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 2550/9155 train_loss=0.2333 lr=2.28e-04 elapsed=2.79 min
[train] step 2600/9155 train_loss=0.2195 lr=2.26e-04 elapsed=2.84 min
[train] step 2650/9155 train_loss=0.1549 lr=2.24e-04 elapsed=2.88 min
[train] step 2700/9155 train_loss=0.1304 lr=2.23e-04 elapsed=2.93 min
[train] step 2750/9155 train_loss=0.2458 lr=2.21e-04 elapsed=2.98 min
[train] step 2800/9155 train_loss=0.2706 lr=2.19e-04 elapsed=3.02 min
[train] step 2850/9155 train_loss=0.1520 lr=2.17e-04 elapsed=3.07 min
[train] step 2900/9155 train_loss=0.1841 lr=2.16e-04 elapsed=3.11 min
[train] step 2950/9155 train_loss=0.2127 lr=2.14e-04 elapsed=3.16 min
[train] step 3000/9155 train_loss=0.1398 lr=2.12e-04 elapsed=3.20 min
[eval] step 3000 val_loss=0.8073
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 3050/9155 train_loss=0.2072 lr=2.11e-04 elapsed=3.32 min
[train] step 3100/9155 train_loss=0.1506 lr=2.09e-04 elapsed=3.37 min
[train] step 3150/9155 train_loss=0.1590 lr=2.07e-04 elapsed=3.42 min
[train] step 3200/9155 train_loss=0.1817 lr=2.05e-04 elapsed=3.46 min
[train] step 3250/9155 train_loss=0.1949 lr=2.04e-04 elapsed=3.51 min
[train] step 3300/9155 train_loss=0.1857 lr=2.02e-04 elapsed=3.55 min
[train] step 3350/9155 train_loss=0.1760 lr=2.00e-04 elapsed=3.60 min
[train] step 3400/9155 train_loss=0.1653 lr=1.98e-04 elapsed=3.65 min
[train] step 3450/9155 train_loss=0.2420 lr=1.97e-04 elapsed=3.69 min
[train] step 3500/9155 train_loss=0.1216 lr=1.95e-04 elapsed=3.74 min
[eval] step 3500 val_loss=0.7944
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 3550/9155 train_loss=0.1198 lr=1.93e-04 elapsed=3.86 min
[train] step 3600/9155 train_loss=0.1739 lr=1.92e-04 elapsed=3.90 min
[train] step 3650/9155 train_loss=0.1220 lr=1.90e-04 elapsed=3.95 min
[train] step 3700/9155 train_loss=0.1715 lr=1.88e-04 elapsed=4.00 min
[train] step 3750/9155 train_loss=0.1503 lr=1.86e-04 elapsed=4.04 min
[train] step 3800/9155 train_loss=0.1739 lr=1.85e-04 elapsed=4.09 min
[train] step 3850/9155 train_loss=0.2089 lr=1.83e-04 elapsed=4.13 min
[train] step 3900/9155 train_loss=0.1353 lr=1.81e-04 elapsed=4.18 min
[train] step 3950/9155 train_loss=0.2189 lr=1.80e-04 elapsed=4.22 min
[train] step 4000/9155 train_loss=0.1972 lr=1.78e-04 elapsed=4.27 min
[eval] step 4000 val_loss=0.7537
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 4050/9155 train_loss=0.1363 lr=1.76e-04 elapsed=4.39 min
[train] step 4100/9155 train_loss=0.1482 lr=1.74e-04 elapsed=4.44 min
[train] step 4150/9155 train_loss=0.2600 lr=1.73e-04 elapsed=4.48 min
[train] step 4200/9155 train_loss=0.1454 lr=1.71e-04 elapsed=4.53 min
[train] step 4250/9155 train_loss=0.2249 lr=1.69e-04 elapsed=4.57 min
[train] step 4300/9155 train_loss=0.1794 lr=1.67e-04 elapsed=4.62 min
[train] step 4350/9155 train_loss=0.2275 lr=1.66e-04 elapsed=4.67 min
[train] step 4400/9155 train_loss=0.2311 lr=1.64e-04 elapsed=4.71 min
[train] step 4450/9155 train_loss=0.1645 lr=1.62e-04 elapsed=4.76 min
[train] step 4500/9155 train_loss=0.1407 lr=1.61e-04 elapsed=4.80 min
[eval] step 4500 val_loss=0.7321
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 4550/9155 train_loss=0.1546 lr=1.59e-04 elapsed=4.92 min
[train] step 4600/9155 train_loss=0.1788 lr=1.57e-04 elapsed=4.97 min
[train] step 4650/9155 train_loss=0.2510 lr=1.55e-04 elapsed=5.02 min
[train] step 4700/9155 train_loss=0.1491 lr=1.54e-04 elapsed=5.06 min
[train] step 4750/9155 train_loss=0.1266 lr=1.52e-04 elapsed=5.11 min
[train] step 4800/9155 train_loss=0.1981 lr=1.50e-04 elapsed=5.15 min
[train] step 4850/9155 train_loss=0.0410 lr=1.48e-04 elapsed=5.20 min
[train] step 4900/9155 train_loss=0.1984 lr=1.47e-04 elapsed=5.25 min
[train] step 4950/9155 train_loss=0.1876 lr=1.45e-04 elapsed=5.29 min
[train] step 5000/9155 train_loss=0.1402 lr=1.43e-04 elapsed=5.34 min
[eval] step 5000 val_loss=0.7217
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 5050/9155 train_loss=0.1849 lr=1.42e-04 elapsed=5.46 min
[train] step 5100/9155 train_loss=0.1362 lr=1.40e-04 elapsed=5.50 min
[train] step 5150/9155 train_loss=0.1947 lr=1.38e-04 elapsed=5.55 min
[train] step 5200/9155 train_loss=0.1513 lr=1.36e-04 elapsed=5.59 min
[train] step 5250/9155 train_loss=0.1644 lr=1.35e-04 elapsed=5.64 min
[train] step 5300/9155 train_loss=0.1399 lr=1.33e-04 elapsed=5.69 min
[train] step 5350/9155 train_loss=0.1401 lr=1.31e-04 elapsed=5.73 min
[train] step 5400/9155 train_loss=0.1984 lr=1.30e-04 elapsed=5.78 min
[train] step 5450/9155 train_loss=0.1490 lr=1.28e-04 elapsed=5.82 min
[train] step 5500/9155 train_loss=0.1353 lr=1.26e-04 elapsed=5.87 min
[eval] step 5500 val_loss=0.7147
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 5550/9155 train_loss=0.2113 lr=1.24e-04 elapsed=5.99 min
[train] step 5600/9155 train_loss=0.2463 lr=1.23e-04 elapsed=6.04 min
[train] step 5650/9155 train_loss=0.2186 lr=1.21e-04 elapsed=6.08 min
[train] step 5700/9155 train_loss=0.1995 lr=1.19e-04 elapsed=6.13 min
[train] step 5750/9155 train_loss=0.1395 lr=1.17e-04 elapsed=6.17 min
[train] step 5800/9155 train_loss=0.1556 lr=1.16e-04 elapsed=6.22 min
[train] step 5850/9155 train_loss=0.1044 lr=1.14e-04 elapsed=6.26 min
[train] step 5900/9155 train_loss=0.0919 lr=1.12e-04 elapsed=6.31 min
[train] step 5950/9155 train_loss=0.1591 lr=1.11e-04 elapsed=6.36 min
[train] step 6000/9155 train_loss=0.1532 lr=1.09e-04 elapsed=6.40 min
[eval] step 6000 val_loss=0.6967
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 6050/9155 train_loss=0.1298 lr=1.07e-04 elapsed=6.52 min
[train] step 6100/9155 train_loss=0.2123 lr=1.05e-04 elapsed=6.57 min
[train] step 6150/9155 train_loss=0.1755 lr=1.04e-04 elapsed=6.61 min
[train] step 6200/9155 train_loss=0.1002 lr=1.02e-04 elapsed=6.66 min
[train] step 6250/9155 train_loss=0.1335 lr=1.00e-04 elapsed=6.71 min
[train] step 6300/9155 train_loss=0.1735 lr=9.85e-05 elapsed=6.75 min
[train] step 6350/9155 train_loss=0.1722 lr=9.67e-05 elapsed=6.80 min
[train] step 6400/9155 train_loss=0.2162 lr=9.50e-05 elapsed=6.84 min
[train] step 6450/9155 train_loss=0.1749 lr=9.33e-05 elapsed=6.89 min
[train] step 6500/9155 train_loss=0.1209 lr=9.16e-05 elapsed=6.93 min
[eval] step 6500 val_loss=0.6845
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 6550/9155 train_loss=0.1664 lr=8.98e-05 elapsed=7.06 min
[train] step 6600/9155 train_loss=0.1720 lr=8.81e-05 elapsed=7.10 min
[train] step 6650/9155 train_loss=0.2080 lr=8.64e-05 elapsed=7.15 min
[train] step 6700/9155 train_loss=0.1102 lr=8.47e-05 elapsed=7.19 min
[train] step 6750/9155 train_loss=0.1827 lr=8.30e-05 elapsed=7.24 min
[train] step 6800/9155 train_loss=0.1759 lr=8.12e-05 elapsed=7.28 min
[train] step 6850/9155 train_loss=0.1395 lr=7.95e-05 elapsed=7.33 min
[train] step 6900/9155 train_loss=0.1523 lr=7.78e-05 elapsed=7.38 min
[train] step 6950/9155 train_loss=0.2310 lr=7.61e-05 elapsed=7.42 min
[train] step 7000/9155 train_loss=0.1714 lr=7.43e-05 elapsed=7.47 min
[eval] step 7000 val_loss=0.6849
[train] step 7050/9155 train_loss=0.1182 lr=7.26e-05 elapsed=7.58 min
[train] step 7100/9155 train_loss=0.1530 lr=7.09e-05 elapsed=7.62 min
[train] step 7150/9155 train_loss=0.2792 lr=6.92e-05 elapsed=7.67 min
[train] step 7200/9155 train_loss=0.1771 lr=6.74e-05 elapsed=7.72 min
[train] step 7250/9155 train_loss=0.1336 lr=6.57e-05 elapsed=7.76 min
[train] step 7300/9155 train_loss=0.1899 lr=6.40e-05 elapsed=7.81 min
[train] step 7350/9155 train_loss=0.1522 lr=6.23e-05 elapsed=7.85 min
[train] step 7400/9155 train_loss=0.1803 lr=6.05e-05 elapsed=7.90 min
[train] step 7450/9155 train_loss=0.2156 lr=5.88e-05 elapsed=7.95 min
[train] step 7500/9155 train_loss=0.1801 lr=5.71e-05 elapsed=7.99 min
[eval] step 7500 val_loss=0.6846
[train] step 7550/9155 train_loss=0.0638 lr=5.54e-05 elapsed=8.10 min
[train] step 7600/9155 train_loss=0.1169 lr=5.36e-05 elapsed=8.15 min
[train] step 7650/9155 train_loss=0.1092 lr=5.19e-05 elapsed=8.19 min
[train] step 7700/9155 train_loss=0.0999 lr=5.02e-05 elapsed=8.24 min
[train] step 7750/9155 train_loss=0.1644 lr=4.85e-05 elapsed=8.29 min
[train] step 7800/9155 train_loss=0.1145 lr=4.67e-05 elapsed=8.33 min
[train] step 7850/9155 train_loss=0.1544 lr=4.50e-05 elapsed=8.38 min
[train] step 7900/9155 train_loss=0.1767 lr=4.33e-05 elapsed=8.42 min
[train] step 7950/9155 train_loss=0.1070 lr=4.16e-05 elapsed=8.47 min
[train] step 8000/9155 train_loss=0.2539 lr=3.98e-05 elapsed=8.52 min
[eval] step 8000 val_loss=0.6769
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 8050/9155 train_loss=0.0728 lr=3.81e-05 elapsed=8.64 min
[train] step 8100/9155 train_loss=0.0548 lr=3.64e-05 elapsed=8.68 min
[train] step 8150/9155 train_loss=0.1055 lr=3.47e-05 elapsed=8.73 min
[train] step 8200/9155 train_loss=0.1606 lr=3.29e-05 elapsed=8.77 min
[train] step 8250/9155 train_loss=0.1880 lr=3.12e-05 elapsed=8.82 min
[train] step 8300/9155 train_loss=0.1126 lr=2.95e-05 elapsed=8.87 min
[train] step 8350/9155 train_loss=0.1688 lr=2.78e-05 elapsed=8.91 min
[train] step 8400/9155 train_loss=0.1909 lr=2.60e-05 elapsed=8.96 min
[train] step 8450/9155 train_loss=0.0868 lr=2.43e-05 elapsed=9.00 min
[train] step 8500/9155 train_loss=0.0979 lr=2.26e-05 elapsed=9.05 min
[eval] step 8500 val_loss=0.6730
[ckpt] Saved new best model to /scratch/dk5288/models2/abc_scaling/xl_best.pt
[train] step 8550/9155 train_loss=0.1594 lr=2.09e-05 elapsed=9.17 min
[train] step 8600/9155 train_loss=0.0513 lr=1.91e-05 elapsed=9.22 min
[train] step 8650/9155 train_loss=0.1594 lr=1.74e-05 elapsed=9.26 min
[train] step 8700/9155 train_loss=0.1576 lr=1.57e-05 elapsed=9.31 min
[train] step 8750/9155 train_loss=0.1432 lr=1.40e-05 elapsed=9.35 min
[train] step 8800/9155 train_loss=0.1625 lr=1.22e-05 elapsed=9.40 min
[train] step 8850/9155 train_loss=0.1418 lr=1.05e-05 elapsed=9.45 min
[train] step 8900/9155 train_loss=0.1421 lr=8.80e-06 elapsed=9.49 min
[train] step 8950/9155 train_loss=0.1077 lr=7.07e-06 elapsed=9.54 min
[train] step 9000/9155 train_loss=0.1119 lr=5.35e-06 elapsed=9.58 min
[eval] step 9000 val_loss=0.6788
[train] step 9050/9155 train_loss=0.1994 lr=3.62e-06 elapsed=9.69 min
[train] step 9100/9155 train_loss=0.1522 lr=1.90e-06 elapsed=9.74 min
[train] step 9150/9155 train_loss=0.2066 lr=1.72e-07 elapsed=9.79 min
[eval] step 9154 val_loss=0.6786
[train] Done. Total training time (one epoch): 9.85 minutes
[train] Peak GPU memory allocated: 9.40 GB
[ckpt] Saved final model to /scratch/dk5288/models2/abc_scaling/xl_final.pt
[logs] Saved training logs to /scratch/dk5288/models2/abc_scaling/xl_train_logs.json
[logs] Saved summary to /scratch/dk5288/models2/abc_scaling/xl_summary.txt
[train] Training script finished cleanly.
Finished xl
All model sizes finished.
